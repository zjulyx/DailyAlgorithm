> é¢˜ç›®éš¾åº¦: ä¸­ç­‰

> [åŸé¢˜é“¾æ¥](https://leetcode-cn.com/problems/legal-binary-search-tree-lcci/)

> ä»Šå¤©ç»§ç»­æ›´æ–°ç¨‹åºå‘˜é¢è¯•é‡‘å…¸ç³»åˆ—, å¤§å®¶åœ¨å…¬ä¼—å· **ç®—æ³•ç²¾é€‰** é‡Œå›å¤ **é¢è¯•é‡‘å…¸** å°±èƒ½çœ‹åˆ°è¯¥ç³»åˆ—å½“å‰è¿è½½çš„æ‰€æœ‰æ–‡ç« äº†, è®°å¾—å…³æ³¨å“¦~

## é¢˜ç›®æè¿°

å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œæ£€æŸ¥ä¸€æ£µäºŒå‰æ ‘æ˜¯å¦ä¸ºäºŒå‰æœç´¢æ ‘ã€‚

### ç¤ºä¾‹ Â 1:

- è¾“å…¥:

```
    2
   / \
  1   3
```

- è¾“å‡º: true

### ç¤ºä¾‹ Â 2:

- è¾“å…¥:

```
    5
   / \
  1   4
Â     / \
Â    3   6
```

- è¾“å‡º: false
- è§£é‡Š: è¾“å…¥ä¸º: [5,1,4,null,null,3,6]ã€‚
  Â  æ ¹èŠ‚ç‚¹çš„å€¼ä¸º 5 ï¼Œä½†æ˜¯å…¶å³å­èŠ‚ç‚¹å€¼ä¸º 4 ã€‚

## é¢˜ç›®æ€è€ƒ

1. å¯ä»¥åˆ©ç”¨äºŒå‰æœç´¢æ ‘çš„å“ªäº›æ€§è´¨æ¥åˆ¤æ–­?

## è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1

#### æ€è·¯

- äºŒå‰æœç´¢æ ‘æœ€ç›´è§‚çš„æ€§è´¨å°±æ˜¯: å½“å‰èŠ‚ç‚¹çš„å€¼å¤§äºå·¦å­æ ‘ä¸Šä»»æ„èŠ‚ç‚¹çš„å€¼, å¹¶å°äºå³å­æ ‘ä¸Šä»»æ„èŠ‚ç‚¹çš„å€¼
- æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€æ€§è´¨, å¼•å…¥å½“å‰æ ‘çš„ä¸Šä¸‹ç•Œæ¥é€’å½’åˆ¤æ–­
- å¦‚æœå½“å‰æ ¹èŠ‚ç‚¹çš„å€¼åœ¨ä¸Šä¸‹ç•ŒèŒƒå›´å†…, åˆ™é€’å½’åˆ¤æ–­å·¦å³å­æ ‘, åŒæ—¶æ›´æ–°å·¦å­æ ‘çš„ä¸Šç•Œå’Œå³å­æ ‘çš„ä¸‹ç•Œä¸ºå½“å‰èŠ‚ç‚¹çš„å€¼; å¦åˆ™è¯´æ˜ä¸æ˜¯åˆæ³•çš„äºŒå‰æœç´¢æ ‘, è¿”å› false
- å¦å¤–æ³¨æ„åˆå§‹åŒ–æ—¶ä¸Šä¸‹ç•Œæ˜¯-inf å’Œ+inf, è¡¨ç¤ºæ•´ä¸ªæ ‘çš„æ ¹èŠ‚ç‚¹å¯ä»¥å–ä»»ä½•å€¼

#### å¤æ‚åº¦

- æ—¶é—´å¤æ‚åº¦ O(N): æ¯ä¸ªèŠ‚ç‚¹åªéœ€è¦éå†ä¸€é
- ç©ºé—´å¤æ‚åº¦ O(logN): é€’å½’æ ˆçš„æ¶ˆè€—, é€’å½’æ·±åº¦æœ€å¤šæ˜¯æ ‘çš„é«˜åº¦, ä¹Ÿå³ logN

#### ä»£ç 

```python
class Solution:
    def isValidBST(self, root: TreeNode) -> bool:
        # æ–¹æ³•1: åŠ å…¥ä¸Šä¸‹ç•Œé€’å½’åˆ¤æ–­
        def check(node, mn, mx):
            # mnå’Œmxè¡¨ç¤ºå½“å‰å­æ ‘çš„ä¸Šä¸‹ç•Œå–å€¼èŒƒå›´, å³å­æ ‘å†…çš„æ‰€æœ‰èŠ‚ç‚¹çš„å€¼éƒ½è¦åœ¨(mn, mx)ä¹‹é—´
            if not node:
                return True
            if not mn < node.val < mx:
                # å½“å‰èŠ‚ç‚¹ä¸å±äºè¯¥èŒƒå›´å†…, è¯´æ˜ä¸æ˜¯åˆæ³•çš„äºŒå‰æœç´¢æ ‘
                return False
            # æ£€æŸ¥å·¦å³å­æ ‘, æ³¨æ„ä¸Šä¸‹ç•Œä¹Ÿè¦æ›´æ–°
            # å³å·¦å­æ ‘çš„mxå’Œå³å­æ ‘çš„mnè¦æ›´æ–°ä¸ºå½“å‰èŠ‚ç‚¹å€¼
            return check(node.left, mn, node.val) & check(
                node.right, node.val, mx)

        # åˆå§‹åŒ–çš„ä¸Šä¸‹ç•Œè‡ªç„¶æ˜¯-infå’Œ+inf
        return check(root, -float('inf'), float('inf'))
```

### æ–¹æ¡ˆ 2

#### æ€è·¯

- äºŒå‰æœç´¢æ ‘è¿˜æœ‰å¦ä¸€ä¸ªæ€§è´¨, å³ä¸­åºéå†æ˜¯æœ‰åºçš„
- æ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨è¿™ä¸€æ€§è´¨, å¼•å…¥é¢å¤–å‚æ•° pre æ¥ä»£è¡¨å‰ä¸€ä¸ªèŠ‚ç‚¹çš„å€¼, å¹¶å¼•å…¥ä¸€ä¸ª valid å¸ƒå°”å€¼è¡¨ç¤ºæ˜¯å¦åˆæ³•
- ç„¶åä¸­åºéå†å¹¶æ¯”è¾ƒ pre å’Œå½“å‰èŠ‚ç‚¹ cur çš„å€¼: å¦‚æœ pre å¤§äºç­‰äºå®ƒçš„è¯åˆ™è¯´æ˜ä¸æ˜¯åˆæ³•çš„äºŒå‰æœç´¢æ ‘, å°† valid ç½®ä¸º false; å¦åˆ™æ›´æ–° pre ä¸ºå½“å‰èŠ‚ç‚¹çš„å€¼, ç”¨äºä¹‹åçš„åˆ¤æ–­, å¹¶ç»§ç»­ä¸­åºéå†
- å¦å¤–æ³¨æ„åˆå§‹åŒ–æ—¶ pre æ˜¯-inf, è¡¨ç¤ºæ•´ä¸ªæ ‘çš„æœ€å°èŠ‚ç‚¹å¯ä»¥å–ä»»ä½•å€¼

#### å¤æ‚åº¦

- æ—¶é—´å¤æ‚åº¦ O(N): æ¯ä¸ªèŠ‚ç‚¹åªéœ€è¦éå†ä¸€é
- ç©ºé—´å¤æ‚åº¦ O(logN): é€’å½’æ ˆçš„æ¶ˆè€—, é€’å½’æ·±åº¦æœ€å¤šæ˜¯æ ‘çš„é«˜åº¦, ä¹Ÿå³ logN

#### ä»£ç 

```python
class Solution:
    def isValidBST(self, root: TreeNode) -> bool:
        # æ–¹æ³•2: ä¸­åºéå†, å¼•å…¥é¢å¤–å‚æ•°preè¡¨ç¤ºä¸Šä¸€ä¸ªå…ƒç´ çš„å€¼
        pre = -float('inf')
        valid = True

        def inorder(node):
            nonlocal pre
            nonlocal valid
            if not node or not valid:
                # å¦‚æœèŠ‚ç‚¹ä¸ºç©ºæˆ–è€…å·²ç»ä¸æ˜¯åˆæ³•äºŒå‰æœç´¢æ ‘äº†, ç›´æ¥é€€å‡º
                return
            inorder(node.left)
            if pre >= node.val:
                # å‰ä¸€ä¸ªå€¼å¤§äºç­‰äºå½“å‰å€¼, ä¸æ»¡è¶³äºŒå‰æœç´¢æ ‘çš„è¦æ±‚, æ— æ•ˆ
                valid = False
                return
            # ä¸è¦å¿˜äº†æ›´æ–°å‰ä¸€ä¸ªå€¼ä¸ºå½“å‰å€¼, ç”¨äºä¸‹ä¸€æ¬¡åˆ¤æ–­
            pre = node.val
            inorder(node.right)

        inorder(root)
        return valid
```

---

> å¤§å®¶å¯ä»¥åœ¨ä¸‹é¢è¿™äº›åœ°æ–¹æ‰¾åˆ°æˆ‘~ğŸ˜Š

> [æˆ‘çš„ GitHub](https://github.com/zjulyx)

> [æˆ‘çš„ Leetcode](https://leetcode-cn.com/u/suibianfahui/)

> [æˆ‘çš„ CSDN](https://me.csdn.net/zjulyx1993)

> [æˆ‘çš„çŸ¥ä¹ä¸“æ ](https://zhuanlan.zhihu.com/c_1242508721932464128)

> [æˆ‘çš„å¤´æ¡å·](https://www.toutiao.com/c/user/1090304683804520/#mid=1671643017345028)

> [æˆ‘çš„ç‰›å®¢ç½‘åšå®¢](https://blog.nowcoder.net/zjulyx)

> æˆ‘çš„å…¬ä¼—å·: [ç®—æ³•ç²¾é€‰](https://mp.weixin.qq.com/s?__biz=MzA5MDk1MjI5MA==&mid=2247484158&idx=1&sn=90176bac32cf7af40e4074c721fd8a95&chksm=900285f3a7750ce5a068c9c9773781461819633f2fd60533732637ec9520c908371ebc218d49&scene=178&cur_album_id=1386231241346859009#rd), æ¬¢è¿å¤§å®¶æ‰«ç å…³æ³¨~ğŸ˜Š

![ç®—æ³•ç²¾é€‰ - å¾®ä¿¡æ‰«ä¸€æ‰«å…³æ³¨æˆ‘](https://pic1.zhimg.com/80/v2-7c988a7b35886df51596ef23616764ac_1440w.jpg)
