> é¢˜ç›®éš¾åº¦: ä¸­ç­‰

> [åŸé¢˜é“¾æ¥](https://leetcode.cn/problems/multi-search-lcci/)

> ä»Šå¤©ç»§ç»­æ›´æ–°ç¨‹åºå‘˜é¢è¯•é‡‘å…¸ç³»åˆ—, å¤§å®¶åœ¨å…¬ä¼—å· **ç®—æ³•ç²¾é€‰** é‡Œå›å¤ **é¢è¯•é‡‘å…¸** å°±èƒ½çœ‹åˆ°è¯¥ç³»åˆ—å½“å‰è¿è½½çš„æ‰€æœ‰æ–‡ç« äº†, è®°å¾—å…³æ³¨å“¦~

## é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªè¾ƒé•¿å­—ç¬¦ä¸² big å’Œä¸€ä¸ªåŒ…å«è¾ƒçŸ­å­—ç¬¦ä¸²çš„æ•°ç»„ smallsï¼Œè®¾è®¡ä¸€ä¸ªæ–¹æ³•ï¼Œæ ¹æ® smalls ä¸­çš„æ¯ä¸€ä¸ªè¾ƒçŸ­å­—ç¬¦ä¸²ï¼Œå¯¹ big è¿›è¡Œæœç´¢ã€‚è¾“å‡º smalls ä¸­çš„å­—ç¬¦ä¸²åœ¨ big é‡Œå‡ºç°çš„æ‰€æœ‰ä½ç½® positionsï¼Œå…¶ä¸­ positions[i]ä¸º smalls[i]å‡ºç°çš„æ‰€æœ‰ä½ç½®ã€‚

### ç¤ºä¾‹ï¼š

- è¾“å…¥ï¼š
  - big = "mississippi"
  - smalls = ["is","ppi","hi","sis","i","ssippi"]
- è¾“å‡ºï¼š
  - [[1,4],[8],[],[3],[1,4,7,10],[5]]

### æç¤ºï¼š

- 0 <= len(big) <= 1000
- 0 <= len(smalls[i]) <= 1000
- smalls çš„æ€»å­—ç¬¦æ•°ä¸ä¼šè¶…è¿‡ 100000ã€‚
- ä½ å¯ä»¥è®¤ä¸º smalls ä¸­æ²¡æœ‰é‡å¤å­—ç¬¦ä¸²ã€‚
- æ‰€æœ‰å‡ºç°çš„å­—ç¬¦å‡ä¸ºè‹±æ–‡å°å†™å­—æ¯ã€‚

## é¢˜ç›®æ€è€ƒ

1. å¦‚ä½•å°½å¯èƒ½ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦?

## è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1

#### æ€è·¯

- åˆ†æé¢˜ç›®, ä¸€ä¸ªå¾ˆå®¹æ˜“æƒ³åˆ°çš„æ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨å„ä¸ªè¯­è¨€æä¾›çš„å­—ç¬¦ä¸² find()å‡½æ•°
- ç„¶åé’ˆå¯¹æ¯ä¸ª small å­—ç¬¦ä¸², æŸ¥æ‰¾å®ƒåœ¨ big å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å¯èƒ½çš„èµ·ç‚¹
- ä»¥ Python3 ä¸ºä¾‹, find()å¯ä»¥ä¼ å…¥å¾…æŸ¥æ‰¾çš„èµ·ç‚¹, å¹¶è¿”å›ä»é‚£ä¸ªèµ·ç‚¹å¼€å§‹æŸ¥æ‰¾åˆ°çš„å­ä¸²çš„é¦–ä¸ªèµ·ç‚¹, å¦‚æœæ²¡æ‰¾åˆ°åˆ™è¿”å›-1
- è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¸åœå¾ªç¯ä¸Šè¿°è¿‡ç¨‹, ç›´åˆ°æ‰¾ä¸åˆ° small å­ä¸²ä¸ºæ­¢
- ä¸‹é¢ä»£ç æœ‰è¯¦ç»†çš„æ³¨é‡Š, æ–¹ä¾¿å¤§å®¶ç†è§£

#### å¤æ‚åº¦

- æ—¶é—´å¤æ‚åº¦ `O(NMS)`: å‡è®¾ N æ˜¯ big å­—ç¬¦ä¸²çš„é•¿åº¦, M æ˜¯ smalls å­—ç¬¦ä¸²æ•°ç»„çš„å…ƒç´ ä¸ªæ•°, S æ˜¯ small å­—ç¬¦ä¸²çš„å¹³å‡é•¿åº¦; åˆ™å¤–å±‚å¾ªç¯å¤æ‚åº¦ä¸º O(M), å†…å±‚å¾ªç¯æœ€å¤šéœ€è¦å¯¹æ¯ä¸ªèµ·ç‚¹åŒ¹é…å¯¹åº”çš„å­ä¸², å°±æ˜¯ O(NS), æ‰€ä»¥æ€»æ—¶é—´å¤æ‚åº¦æ˜¯ O(NMS)
- ç©ºé—´å¤æ‚åº¦ `O(1)`: é™¤äº†ç»“æœæ•°ç»„å¤–, æ²¡æœ‰ä½¿ç”¨é¢å¤–çš„ç©ºé—´

#### ä»£ç 

```python
class Solution:
    def multiSearch(self, big: str, smalls: List[str]) -> List[List[int]]:
        # æ–¹æ³•1: è¯­è¨€è‡ªå¸¦find
        res = []
        for s in smalls:
            res.append([])
            # åˆå§‹åŒ–èµ·ç‚¹ä¸º-1, å› ä¸ºä¸‹é¢çš„findé€»è¾‘æ˜¯ä»i+1å¼€å§‹æŸ¥æ‰¾
            i = -1
            if s != "":
                while True:
                    # iæ˜¯ä¸Šä¸€ä¸ªæŸ¥æ‰¾åˆ°çš„èµ·ç‚¹, æ¥ä¸‹æ¥ä»i+1å¼€å§‹æŸ¥, ä¿è¯ä¸é‡å¤
                    i = big.find(s, i + 1)
                    if i != -1:
                        # æ‰¾åˆ°äº†, è¿½åŠ èµ·ç‚¹
                        res[-1].append(i)
                    else:
                        # æ²¡æ‰¾åˆ°, è·³å‡ºå¾ªç¯
                        break
        return res
```

### æ–¹æ¡ˆ 2

#### æ€è·¯

- å›é¡¾æ–¹æ¡ˆ 1, å¯ä»¥å‘ç°å®ƒåœ¨æŸ¥æ‰¾èµ·ç‚¹æ—¶ä¼šè¿›è¡Œå¾ˆå¤šé‡å¤çš„åŒ¹é…, æ•ˆç‡æ¯”è¾ƒä½, æœ‰æ²¡æœ‰æ›´ä¼˜çš„æ–¹æ¡ˆå‘¢?
- é‡æ–°åˆ†æé¢˜ç›®, æˆ‘ä»¬å¯ä»¥å‘ç°, æŸä¸ª small å­—ç¬¦ä¸²è¦æƒ³æˆä¸º big çš„å­ä¸², åˆ™å®ƒä¸€å®šæ˜¯ big ä»æŸä¸ªèµ·ç‚¹å¼€å§‹çš„**å‰ç¼€**
- æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¯ä»¥å¼•å…¥å‰ç¼€æ ‘ trie, å°†æ‰€æœ‰ small å­—ç¬¦ä¸²åŠ å…¥ trie ä¸­
- ç„¶åä¾æ¬¡éå† big çš„æ¯ä¸ªèµ·ç‚¹, æŸ¥æ‰¾ä»å®ƒå¼€å§‹çš„æŸä¸ªå‰ç¼€æ˜¯å¦å·²ç»åœ¨ trie ä¸­, æ˜¯çš„è¯åˆ™è¯´æ˜è¯¥å‰ç¼€å°±æ˜¯ä¸€ä¸ª small å­—ç¬¦ä¸²
- è¿™é‡Œæˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸ªèŠ‚ç‚¹é¢å¤–åŠ ä¸Šä¸€ä¸ªå±æ€§ index, æ¥ä»£è¡¨å½“å‰ small å­—ç¬¦ä¸²çš„ä¸‹æ ‡
- è¿™æ ·åœ¨æ‰¾åˆ°ä¸€ä¸ªå‰ç¼€å, æˆ‘ä»¬å°±å¯ä»¥å¯¹ç»“æœåˆ—è¡¨å¯¹åº”çš„ä¸‹æ ‡å¤„è¿½åŠ ä¸Šå½“å‰çš„ big èµ·ç‚¹äº†
- ä¸‹é¢ä»£ç æœ‰è¯¦ç»†çš„æ³¨é‡Š, æ–¹ä¾¿å¤§å®¶ç†è§£

#### å¤æ‚åº¦

- æ—¶é—´å¤æ‚åº¦ `O(MS+NS)`: å‡è®¾ N æ˜¯ big å­—ç¬¦ä¸²çš„é•¿åº¦, M æ˜¯ smalls å­—ç¬¦ä¸²æ•°ç»„çš„å…ƒç´ ä¸ªæ•°, S æ˜¯ small å­—ç¬¦ä¸²çš„å¹³å‡é•¿åº¦; åˆ™æ’å…¥ trie çš„å¤æ‚åº¦ä¸º O(MS), æŸ¥æ‰¾èµ·ç‚¹æ—¶, å¤–å±‚å¾ªç¯å¤æ‚åº¦ä¸º O(N), å†…å±‚æœ€å¤šéå† S å±‚, å¤æ‚åº¦ä¸º O(S), æ‰€ä»¥è¿™éƒ¨åˆ†æ€»å¤æ‚åº¦ä¸º O(NS)
- ç©ºé—´å¤æ‚åº¦ `O(MS)`: éœ€è¦å­˜å‚¨ small å­—ç¬¦ä¸²åˆ—è¡¨çš„æ‰€æœ‰å­—ç¬¦

#### ä»£ç 

```python
class Solution:
    def multiSearch(self, big: str, smalls: List[str]) -> List[List[int]]:
        # æ–¹æ³•2: é€†å‘æ€è€ƒ+trieå­˜small+éå†bigèµ·ç‚¹
        class Node:
            def __init__(self, c):
                self.c = c
                # childrenå­—å…¸, å­˜å‚¨å­—ç¬¦åˆ°èŠ‚ç‚¹çš„æ˜ å°„
                self.children = {}
                # smallå­—ç¬¦ä¸²ä¸‹æ ‡, åˆå§‹åŒ–ä¸º-1, åªæœ‰å½“éå†åˆ°smallæœ€åä¸€ä¸ªå­—ç¬¦æ—¶æ‰èµ‹å€¼, ä¿è¯å®Œæ•´æ€§
                self.index = -1

        n, m = len(big), len(smalls)
        root = Node("")
        for i, w in enumerate(smalls):
            # å°†å½“å‰å­—ç¬¦ä¸²åŠ å…¥trieä¸­, è¾¾åˆ°ç»ˆç‚¹æ—¶è®°å½•å½“å‰ä¸‹æ ‡
            # å› ä¸ºsmallsçš„å­—ç¬¦ä¸²éƒ½ä¸é‡å¤, æ‰€ä»¥ä¸å­˜åœ¨ä¸‹æ ‡è¦†ç›–çš„æƒ…å†µ
            cur = root
            for c in w:
                if c not in cur.children:
                    cur.children[c] = Node(c)
                cur = cur.children[c]
            # èµ‹å€¼ä¸‹æ ‡, ä»rootåˆ°curçš„è·¯å¾„å½¢æˆäº†å®Œæ•´çš„å½“å‰smallå­—ç¬¦ä¸²
            cur.index = i
        # é¢„ç”Ÿæˆç»“æœåˆ—è¡¨
        res = [[] for _ in range(m)]
        for start in range(n):
            # éå†bigçš„æ¯ä¸ªèµ·ç‚¹start
            cur = root
            i = start
            while cur and i < n:
                c = big[i]
                if c not in cur.children:
                    # å½“å‰å­—ç¬¦ä¸åœ¨trieä¸­, åé¢å°±æ›´ä¸å­˜åœ¨æœ‰æ•ˆçš„smallå­—ç¬¦ä¸²äº†, ç›´æ¥é€€å‡ºå¾ªç¯
                    break
                # è¿›å…¥ä¸‹ä¸€å±‚
                cur = cur.children[c]
                i += 1
                if cur.index != -1:
                    # å½“å‰èŠ‚ç‚¹ç´¢å¼•ä¸æ˜¯-1, è¯´æ˜æ‰¾åˆ°äº†ä¸€ä¸ªå®Œæ•´çš„smallå­—ç¬¦ä¸² (ä»rootä¸€è·¯åˆ°cur)
                    # æ­¤æ—¶éœ€è¦å°†ç»“æœåˆ—è¡¨çš„smallä¸‹æ ‡å¤„è¿½åŠ ä¸Šå½“å‰bigçš„èµ·ç‚¹start, è¡¨ç¤ºè¿™ä¸ªsmallå­—ç¬¦ä¸²åœ¨startä½ç½®å¤„å‡ºç°
                    res[cur.index].append(start)
        return res
```

---

> å¤§å®¶å¯ä»¥åœ¨ä¸‹é¢è¿™äº›åœ°æ–¹æ‰¾åˆ°æˆ‘~ğŸ˜Š

> [æˆ‘çš„ GitHub](https://github.com/zjulyx)

> [æˆ‘çš„ Leetcode](https://leetcode-cn.com/u/suibianfahui/)

> [æˆ‘çš„ CSDN](https://me.csdn.net/zjulyx1993)

> [æˆ‘çš„çŸ¥ä¹ä¸“æ ](https://zhuanlan.zhihu.com/c_1242508721932464128)

> [æˆ‘çš„å¤´æ¡å·](https://www.toutiao.com/c/user/1090304683804520/#mid=1671643017345028)

> [æˆ‘çš„ç‰›å®¢ç½‘åšå®¢](https://blog.nowcoder.net/zjulyx)

> æˆ‘çš„å…¬ä¼—å·: [ç®—æ³•ç²¾é€‰](https://mp.weixin.qq.com/s?__biz=MzA5MDk1MjI5MA==&mid=2247484158&idx=1&sn=90176bac32cf7af40e4074c721fd8a95&chksm=900285f3a7750ce5a068c9c9773781461819633f2fd60533732637ec9520c908371ebc218d49&scene=178&cur_album_id=1386231241346859009#rd), æ¬¢è¿å¤§å®¶æ‰«ç å…³æ³¨~ğŸ˜Š

![ç®—æ³•ç²¾é€‰ - å¾®ä¿¡æ‰«ä¸€æ‰«å…³æ³¨æˆ‘](https://pic1.zhimg.com/80/v2-7c988a7b35886df51596ef23616764ac_1440w.jpg)
