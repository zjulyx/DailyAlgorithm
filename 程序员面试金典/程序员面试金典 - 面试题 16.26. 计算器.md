> é¢˜ç›®éš¾åº¦: ä¸­ç­‰

> [åŸé¢˜é“¾æ¥](https://leetcode-cn.com/problems/calculator-lcci/)

> ä»Šå¤©ç»§ç»­æ›´æ–°ç¨‹åºå‘˜é¢è¯•é‡‘å…¸ç³»åˆ—, å¤§å®¶åœ¨å…¬ä¼—å· **ç®—æ³•ç²¾é€‰** é‡Œå›å¤ **é¢è¯•é‡‘å…¸** å°±èƒ½çœ‹åˆ°è¯¥ç³»åˆ—å½“å‰è¿è½½çš„æ‰€æœ‰æ–‡ç« äº†, è®°å¾—å…³æ³¨å“¦~

## é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªåŒ…å«æ­£æ•´æ•°ã€åŠ (+)ã€å‡(-)ã€ä¹˜(\*)ã€é™¤(/)çš„ç®—æ•°è¡¨è¾¾å¼(æ‹¬å·é™¤å¤–)ï¼Œè®¡ç®—å…¶ç»“æœã€‚

è¡¨è¾¾å¼ä»…åŒ…å«éè´Ÿæ•´æ•°ï¼Œ+ï¼Œ - ï¼Œ\*ï¼Œ/ å››ç§è¿ç®—ç¬¦å’Œç©ºæ ¼ ã€‚ æ•´æ•°é™¤æ³•ä»…ä¿ç•™æ•´æ•°éƒ¨åˆ†ã€‚

### ç¤ºä¾‹ 1:

- è¾“å…¥: "3+2\*2"
- è¾“å‡º: 7

### ç¤ºä¾‹ 2:

- è¾“å…¥: " 3/2 "
- è¾“å‡º: 1

### ç¤ºä¾‹ 3:

- è¾“å…¥: " 3+5 / 2 "
- è¾“å‡º: 5

### è¯´æ˜ï¼š

- ä½ å¯ä»¥å‡è®¾æ‰€ç»™å®šçš„è¡¨è¾¾å¼éƒ½æ˜¯æœ‰æ•ˆçš„ã€‚
- è¯·ä¸è¦ä½¿ç”¨å†…ç½®çš„åº“å‡½æ•° evalã€‚

## é¢˜ç›®æ€è€ƒ

1. éœ€è¦ä½¿ç”¨å“ªäº›æ•°æ®ç»“æ„?
2. ä»€ä¹ˆæ—¶å€™è¿›è¡Œè¿ç®—?

## è§£å†³æ–¹æ¡ˆ

### æ€è·¯

- åˆ†æé¢˜ç›®, æ€»å…±æœ‰ 4 ç§è¿ç®—, ä¸”å­˜åœ¨ä¸åŒçš„ä¼˜å…ˆçº§, æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½é‡åˆ°ä¸€ä¸ªè¿ç®—ç¬¦å°±ç›´æ¥å°†å…¶å·¦å³ä¸¤è¾¹çš„æ•°å­—è¿›è¡Œè¿ç®—, è¿™æ ·æœ‰å¯èƒ½ç ´åä¼˜å…ˆçº§å…³ç³»
- ä¾‹å¦‚ 1+2\*3, æˆ‘ä»¬ä¸èƒ½å…ˆè®¡ç®— 1+2, é‚£æ ·ç»“æœå°±å®Œå…¨é”™äº†
- è€Œå¯¹äº 1-2+3 æˆ– 1\*2+3, åˆ™æ˜¯ä»å·¦åˆ°å³è®¡ç®—
- æ€»ç»“æ¥è¯´, å¯¹äºå‰åä¸¤ä¸ªå­—ç¬¦ op1 å’Œ op2, æœ‰ä»¥ä¸‹ä¸¤ç§æƒ…å†µ:
  1. op1 ä¼˜å…ˆçº§**å¤§äºç­‰äº** op2 (ä¾‹å¦‚\*å’Œ+, -å’Œ+), åˆ™æ­£å¸¸**ä»å·¦å‘å³**è®¡ç®—;
  2. op1 ä¼˜å…ˆçº§**å°äº** op2 (ä¾‹å¦‚+å’Œ\*, -å’Œ/), åˆ™éœ€è¦**ä»å³å‘å·¦**è®¡ç®—
- æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨**æ ˆ**æ¥å®ç°ä¸åŒé¡ºåºçš„è®¡ç®—: é¦–å…ˆå®šä¹‰å¥½æ¯ä¸ªè¿ç®—ç¬¦çš„ä¼˜å…ˆçº§, ç„¶ååˆå§‹åŒ–æ•°å­—æ ˆå’Œè¿ç®—ç¬¦æ ˆ, åˆ†åˆ«ç”¨äºä¿å­˜éå†çš„æ•°å­—å’Œè¿ç®—ç¬¦
- éå†è¿‡ç¨‹åˆ†ä¸ºä¸¤ç§æƒ…å†µ:
  1. å¦‚æœæ ˆé¡¶è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§å¤§äºç­‰äºå½“å‰è¿ç®—ç¬¦, åˆ™ä¼˜å…ˆä½¿ç”¨æ ˆé¡¶è¿ç®—ç¬¦æ¥è®¡ç®—æ ˆé¡¶çš„ä¸¤ä¸ªæ•°å­—, æ¨¡æ‹Ÿ**ä»å·¦åˆ°å³**è®¡ç®—;
  2. å¦åˆ™å°±å…ˆå°†å½“å‰è¿ç®—ç¬¦å‹å…¥æ ˆä¸­, ç­‰å¾…åç»­å¤„ç†
- å½“éå†ç»“æŸå, å‡å¦‚è¿ç®—ç¬¦æ ˆä¸­ä»æœ‰å…ƒç´ , åˆ™å…¶ä»æ ˆé¡¶åˆ°æ ˆåº•ä¸€å®šæ˜¯ä¼˜å…ˆçº§å•è°ƒé€’å‡çš„æƒ…å†µ, å¦åˆ™ä¼šåœ¨ä¸Šé¢çš„æƒ…å†µ 1 ä¸­ç›´æ¥è®¡ç®—
- æ­¤æ—¶æˆ‘ä»¬å°±ä»æ ˆé¡¶å¼€å§‹, ä¾æ¬¡è®¡ç®—æ ˆé¡¶ä¸¤ä¸ªæ•°å­—, ç›´åˆ°è¿ç®—ç¬¦æ ˆä¸ºç©ºä¸ºæ­¢, è¿™å°±æ¨¡æ‹Ÿäº†**ä»å³å‘å·¦**è®¡ç®—çš„è¿‡ç¨‹
- æœ€å, æ•°å­—æ ˆä¸­ä¸€å®šåªç•™ä¸‹ä¸€ä¸ªæ•°å­—, å³ä¸ºæœ€ç»ˆç»“æœ
- ä¸‹é¢çš„ä»£ç å¯¹å¿…è¦æ­¥éª¤æœ‰è¯¦ç»†çš„è§£é‡Š, æ–¹ä¾¿å¤§å®¶ç†è§£

### å¤æ‚åº¦

- æ—¶é—´å¤æ‚åº¦ O(N): éå†å­—ç¬¦éœ€è¦ O(N), è®¡ç®—æ•°å­—ä¹Ÿéœ€è¦ O(N)
- ç©ºé—´å¤æ‚åº¦ O(N): ä½¿ç”¨ä¸¤ä¸ªæ ˆåˆ†åˆ«å­˜å‚¨æ•°å­—å’Œè¿ç®—ç¬¦

### ä»£ç 

```python
class Solution:
    def calculate(self, s: str) -> int:
        i = 0
        numStack = []
        opStack = []
        pri = {
            "*": 1,
            "/": 1,
            "+": 2,
            "-": 2,
        }

        def calTwo():
            # ä½¿ç”¨opStackæ ˆé¡¶è¿ç®—ç¬¦ä»¥åŠnumStackæ ˆé¡¶ä¸¤å…ƒç´ ä½œä¸ºè¿ç®—æ•°, è¿›è¡Œè®¡ç®—
            if len(numStack) < 2 or len(opStack) < 1:
                # å…ƒç´ æ•°ç›®ä¸å¤Ÿ, æ— æ•ˆ
                return
            # å¼¹å‡ºnumStackæ ˆçš„ä¸¤ä¸ªæ•°å­—, ä»¥åŠopStackæ ˆçš„ä¸€ä¸ªè¿ç®—ç¬¦
            # æ³¨æ„æ ˆé¡¶æ˜¯ç¬¬äºŒä¸ªæ“ä½œæ•°
            b, a = numStack.pop(), numStack.pop()
            op = opStack.pop()
            # æ ¹æ®è¿ç®—ç¬¦çš„ä¸åŒæ¥è®¡ç®—ç»“æœ, å¹¶å°†ç»“æœå‹å…¥æ ˆä¸­
            if op == "+":
                numStack.append(a + b)
            elif op == "-":
                numStack.append(a - b)
            elif op == "*":
                numStack.append(a * b)
            elif op == "/":
                numStack.append(int(a / b))

        while i < len(s):
            if "0" <= s[i] <= "9":
                # å½“å‰æ˜¯æ•°å­—å¼€å¤´, ç›´æ¥éå†å¾—åˆ°æ•´ä¸ªæ•°å­—, å¹¶åŠ å…¥æ•°å­—æ ˆ
                j = i
                num = 0
                while j < len(s) and "0" <= s[j] <= "9":
                    num = 10 * num + int(s[j])
                    j += 1
                numStack.append(num)
                i = j - 1
            elif s[i] != " ":
                # å½“å‰æ˜¯è¿ç®—ç¬¦
                while opStack and pri[opStack[-1]] <= pri[s[i]]:
                    # æ³¨æ„å¦‚æœæ ˆé¡¶è¿ç®—ç¬¦ä¼˜å…ˆçº§ç­‰äºæˆ–é«˜äºå½“å‰è¿ç®—ç¬¦, åˆ™ä¼˜å…ˆè®¡ç®—æ ˆé¡¶çš„ä¸¤ä¸ªæ•°å­—
                    # ä¾‹å¦‚1*2/3, éå†åˆ°/æ—¶å…ˆè®¡ç®—1*2, åŒç†1*2+3ä¹Ÿæ˜¯å¦‚æ­¤
                    # è€Œå¯¹äº1+2*3, éå†åˆ°*æ—¶ç”±äº+çš„ä¼˜å…ˆçº§ä½, æ‰€ä»¥ä¸å…ˆè®¡ç®—1+2
                    calTwo()
                opStack.append(s[i])
            i += 1
        # å¦‚æœopStackä»æœ‰å…ƒç´ , åˆ™å…¶ä»æ ˆé¡¶åˆ°æ ˆåº•ä¸€å®šæ˜¯ä¼˜å…ˆçº§å•è°ƒé€’å‡çš„æƒ…å†µ(å¦åˆ™ä¼šåœ¨ä¸Šé¢ç›´æ¥è®¡ç®—)
        # å¯¹åº”äºä¸Šé¢ä¾‹å­çš„1+2*3çš„æƒ…å†µ, å…ˆè®¡ç®—2*3å¾—åˆ°6, ç„¶åå°†6å‹å…¥æ ˆä¸­å†è®¡ç®—1+6
        while opStack:
            calTwo()
        return numStack[-1]
```

---

> å¤§å®¶å¯ä»¥åœ¨ä¸‹é¢è¿™äº›åœ°æ–¹æ‰¾åˆ°æˆ‘~ğŸ˜Š

> [æˆ‘çš„ GitHub](https://github.com/zjulyx)

> [æˆ‘çš„ Leetcode](https://leetcode-cn.com/u/suibianfahui/)

> [æˆ‘çš„ CSDN](https://me.csdn.net/zjulyx1993)

> [æˆ‘çš„çŸ¥ä¹ä¸“æ ](https://zhuanlan.zhihu.com/c_1242508721932464128)

> [æˆ‘çš„å¤´æ¡å·](https://www.toutiao.com/c/user/1090304683804520/#mid=1671643017345028)

> [æˆ‘çš„ç‰›å®¢ç½‘åšå®¢](https://blog.nowcoder.net/zjulyx)

> æˆ‘çš„å…¬ä¼—å·: [ç®—æ³•ç²¾é€‰](https://mp.weixin.qq.com/s?__biz=MzA5MDk1MjI5MA==&mid=2247484158&idx=1&sn=90176bac32cf7af40e4074c721fd8a95&chksm=900285f3a7750ce5a068c9c9773781461819633f2fd60533732637ec9520c908371ebc218d49&scene=178&cur_album_id=1386231241346859009#rd), æ¬¢è¿å¤§å®¶æ‰«ç å…³æ³¨~ğŸ˜Š

![ç®—æ³•ç²¾é€‰ - å¾®ä¿¡æ‰«ä¸€æ‰«å…³æ³¨æˆ‘](https://pic1.zhimg.com/80/v2-7c988a7b35886df51596ef23616764ac_1440w.jpg)
