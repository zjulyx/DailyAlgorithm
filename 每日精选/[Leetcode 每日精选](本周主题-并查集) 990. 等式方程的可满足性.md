> é¢˜ç›®éš¾åº¦: ä¸­ç­‰

> [åŸé¢˜é“¾æ¥](https://leetcode-cn.com/problems/satisfiability-of-equality-equations/)

> ä»Šå¤©çš„æ¯æ—¥ä¸€é¢˜æ˜¯æœ‰å…³å¹¶æŸ¥é›†çš„å†…å®¹, æ­£å¥½å¹¶æŸ¥é›†æ€è·¯ç®€å•, å‡ºç°é¢‘ç‡ä¸ä½, å˜ç§ä¹Ÿæœ‰å¾ˆå¤š, è¿˜æ˜¯æŒºæœ‰æ„æ€çš„, è¿™å‘¨å°±æ¥åšè¿™ä¸ªç³»åˆ—çš„å§. å¤§å®¶åœ¨æˆ‘çš„å…¬ä¼—å·"æ¯æ—¥ç²¾é€‰ç®—æ³•é¢˜"ä¸­çš„èŠå¤©æ¡†ä¸­å›å¤ **å¹¶æŸ¥é›†** å°±èƒ½çœ‹åˆ°è¯¥ç³»åˆ—å½“å‰å·²ç»æ›´æ–°çš„æ–‡ç« äº†

> å¤§å®¶æœ‰ä»€ä¹ˆæƒ³æ³•å»ºè®®å’Œåé¦ˆçš„è¯æ¬¢è¿éšæ—¶äº¤æµ, åŒ…æ‹¬ä½†ä¸é™äºå…¬ä¼—å·èŠå¤©æ¡†/çŸ¥ä¹ç§ä¿¡è¯„è®ºç­‰ç­‰~

## é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªç”±è¡¨ç¤ºå˜é‡ä¹‹é—´å…³ç³»çš„å­—ç¬¦ä¸²æ–¹ç¨‹ç»„æˆçš„æ•°ç»„ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²æ–¹ç¨‹ equations[i] çš„é•¿åº¦ä¸º 4ï¼Œå¹¶é‡‡ç”¨ä¸¤ç§ä¸åŒçš„å½¢å¼ä¹‹ä¸€ï¼š"a==b" æˆ– Â "a!=b"ã€‚åœ¨è¿™é‡Œï¼Œa å’Œ b æ˜¯å°å†™å­—æ¯ï¼ˆä¸ä¸€å®šä¸åŒï¼‰ï¼Œè¡¨ç¤ºå•å­—æ¯å˜é‡åã€‚

åªæœ‰å½“å¯ä»¥å°†æ•´æ•°åˆ†é…ç»™å˜é‡åï¼Œä»¥ä¾¿æ»¡è¶³æ‰€æœ‰ç»™å®šçš„æ–¹ç¨‹æ—¶æ‰è¿”å› Â trueï¼Œå¦åˆ™è¿”å› falseã€‚

- 1 <= equations.length <= 500
- equations[i].length == 4
- equations[i][0] å’Œ Â equations[i][3]Â  æ˜¯å°å†™å­—æ¯
- equations[i][1] è¦ä¹ˆæ˜¯ Â '='ï¼Œè¦ä¹ˆæ˜¯ Â '!'
- equations[i][2]Â  æ˜¯ Â '='

## é¢˜ç›®æ ·ä¾‹

### ç¤ºä¾‹ 1

#### è¾“å…¥

["a==b","b!=a"]

#### è¾“å‡º

false

#### è§£é‡Š

å¦‚æœæˆ‘ä»¬æŒ‡å®šï¼Œa = 1 ä¸” b = 1ï¼Œé‚£ä¹ˆå¯ä»¥æ»¡è¶³ç¬¬ä¸€ä¸ªæ–¹ç¨‹ï¼Œä½†æ— æ³•æ»¡è¶³ç¬¬äºŒä¸ªæ–¹ç¨‹ã€‚æ²¡æœ‰åŠæ³•åˆ†é…å˜é‡åŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªæ–¹ç¨‹ã€‚

### ç¤ºä¾‹ 2

#### è¾“å…¥

["b==a","a==b"]

#### è¾“å‡º

true

#### è§£é‡Š

æˆ‘ä»¬å¯ä»¥æŒ‡å®š a = 1 ä¸” b = 1 ä»¥æ»¡è¶³æ»¡è¶³è¿™ä¸¤ä¸ªæ–¹ç¨‹ã€‚

## é¢˜ç›®æ€è€ƒ

1. é¢˜ç›®ä¹ä¸€çœ‹æŒºå¤æ‚çš„, ä½†èƒ½å¦æ¢ä¸ªè§’åº¦æ€è€ƒ: ä»€ä¹ˆæƒ…å†µä¸‹ä¸€å®šä¸æ»¡è¶³ç­‰å¼?
2. å¦‚ä½•åˆ©ç”¨ä¸¤ä¸ªå˜é‡ç›¸ç­‰è¿™ä¸€æ¡ä»¶?

## è§£å†³æ–¹æ¡ˆ

### æ€è·¯

- **åˆ†æ**
  - é¢˜ç›®åªæœ‰ä¸¤ç§æ–¹ç¨‹, ç­‰äºå’Œä¸ç­‰
  - æˆ‘ä»¬å¦‚æœèƒ½å¤Ÿæ±‡æ€»å‡ºæ‰€æœ‰å˜é‡çš„ç›¸ç­‰æ€§, ç„¶åé’ˆå¯¹ä¸ç­‰çš„æ–¹ç¨‹, çœ‹çœ‹å¯¹åº”çš„å˜é‡æ˜¯å¦å·²ç»å­˜åœ¨ç›¸ç­‰å…³ç³», å°±çŸ¥é“èƒ½å¦æ»¡è¶³äº†
- **æ¨å¯¼**
  - å…ˆéå†ä¸€éæ–¹ç¨‹, æ­¤æ—¶åªå…³æ³¨**ç›¸ç­‰**çš„æƒ…å†µ. æˆ‘ä»¬å¯ä»¥æŠŠç›¸ç­‰çš„å˜é‡å½’ä¸ºä¸€ç±», è¿™æ ·å¯ä»¥äº§ç”Ÿè‹¥å¹²ä¸ªé›†åˆ, ç„¶åæ¯ä¸ªé›†åˆä¸­æœ‰è‹¥å¹²ä¸ªå…ƒç´ , å®ƒä»¬éƒ½æ˜¯ç›¸ç­‰çš„
  - ç„¶åå†éå†ä¸€éæ–¹ç¨‹, æ­¤æ—¶åªå…³æ³¨**ä¸ç­‰**çš„æƒ…å†µ. å¦‚æœä¸ç­‰å¼ä¸¤è¾¹çš„å˜é‡å·²ç»å‡ºç°åœ¨ç›¸åŒé›†åˆä¸­äº†, é‚£ä¹ˆå°±ä¼šäº§ç”ŸçŸ›ç›¾, ä¸€å®šæ— æ³•åŒæ—¶æ»¡è¶³æ‰€æœ‰æ–¹ç¨‹. åä¹‹æˆ‘ä»¬æ€»èƒ½å¤ŸæŒ‡å®šä¸åŒçš„æ•°åˆ°å˜é‡, ä½¿å¾—æ»¡è¶³æ‰€æœ‰æ–¹ç¨‹.
- **å®ç°**
  - æ ¹æ®æ¨å¯¼è¿‡ç¨‹, è¿™ä¸ªå°±æ˜¯ç»å…¸çš„[å¹¶æŸ¥é›†](https://zh.wikipedia.org/wiki/%E5%B9%B6%E6%9F%A5%E9%9B%86)æ‰€åšçš„äº‹æƒ…, å°±æ˜¯å°†å…ƒç´ è¿›è¡Œåˆ†ç±», ç›¸åŒçš„æ”¾åœ¨åŒä¸€ä¸ªé›†åˆä¸­. å½“ç„¶é æš´åŠ›æ¨¡æ‹Ÿä¹Ÿå¯ä»¥åšåˆ°å½’ç±», ä½†æ˜¯é‚£æ ·ä¼šæ¶‰åŠåˆ°è€—æ—¶å·¨å¤§çš„é›†åˆæ±‚å¹¶é›†å’Œå¾ªç¯åˆ¤æ–­ç­‰, æ•ˆç‡è¿‡ä½; è€Œå¹¶æŸ¥é›†å¯ä»¥åšåˆ°æ¯æ¬¡æ“ä½œåªéœ€è¦ O(logN)ç”šè‡³æ›´çŸ­çš„æ—¶é—´.
  - å¹¶æŸ¥é›†çš„æ€è·¯å¾ˆç®€å•, å…·ä½“æ­¥éª¤å¦‚ä¸‹:
    1. é¦–å…ˆæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªå­—å…¸ pre, pre[x]è¡¨ç¤º x çš„ç¥–å…ˆ, å¦‚æœä¸¤ä¸ªå…ƒç´ å…·æœ‰ç›¸åŒç¥–å…ˆ, å°±è¡¨ç¤ºå®ƒä»¬åœ¨åŒä¸€ä¸ªé›†åˆä¸­. å¯ä»¥æŠŠç¥–å…ˆ pre[x] æƒ³è±¡æˆä¸€ä¸ªæ ‘çš„æ ¹èŠ‚ç‚¹, é‚£ä¹ˆ x å°±æ˜¯æ ‘ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹(å¯èƒ½æ˜¯æ ¹èŠ‚ç‚¹æœ¬èº«)
    2. ç„¶åå®šä¹‰ä¸€ä¸ª find æ–¹æ³•, æŸ¥æ‰¾å½“å‰å…ƒç´ çš„ç¥–å…ˆ, å¦‚æœç¥–å…ˆä¸å­˜åœ¨çš„è¯å°±æŠŠè‡ªèº«å½“åšç¥–å…ˆ. è¿™é‡Œç”¨åˆ°äº†è·¯å¾„å‹ç¼©çš„ä¼˜åŒ–, å°±æ˜¯è¯´å½“å‘ç°è‡ªå·±çš„ç¥–å…ˆä¸æ˜¯è‡ªèº«çš„æ—¶å€™, å°±å°è¯•æŠŠè‡ªå·±çš„ç¥–å…ˆè®¾ç½®ä¸ºè‡ªå·±çš„å½“å‰ç¥–å…ˆçš„ç¥–å…ˆ, ä»è€Œé™ä½æ ‘çš„é«˜åº¦, åŠ å¿«ä¹‹åçš„æŸ¥æ‰¾è¿‡ç¨‹.
    3. æœ€åå®šä¹‰ä¸€ä¸ª union æ–¹æ³•, ç”¨äºåˆå¹¶ä¸¤ä¸ªå…ƒç´ . è¿™é‡Œçš„æ€è·¯ä¹Ÿå¾ˆç®€å•, å°±æ˜¯æ‰¾åˆ°å„è‡ªçš„ç¥–å…ˆ, ç„¶åå°†å…¶ä¸­ä¸€ä¸ªçš„ç¥–å…ˆçš„ç¥–å…ˆè®¾ç½®ä¸ºå¦å¤–ä¸€ä¸ªç¥–å…ˆå³å¯, ç­‰äºå°±æŠŠä¸¤ä¸ªæ ‘åˆå¹¶åœ¨äº†ä¸€èµ·.
  - ä¸‹é¢çš„ä»£ç ä¸­å¯¹æ¯ä¸ªæ­¥éª¤éƒ½æœ‰æ³¨é‡Š, å¤§å®¶å¯ä»¥ç»“åˆä»£ç å’Œä¸Šé¢çš„æ­¥éª¤æ¥ç†è§£å¹¶æŸ¥é›†çš„æ€è·¯.
  - æ³¨æ„åœ¨æ±‚æ¯ä¸ªèŠ‚ç‚¹çš„ç¥–å…ˆæ—¶ä»ç„¶éœ€è¦è°ƒç”¨ find(), åˆ©ç”¨è·¯å¾„å‹ç¼©å¾—åˆ°æœ€ç»ˆæœ€æ ¹éƒ¨çš„ç¥–å…ˆ, è€Œä¸æ˜¯ç›´æ¥æ‹¿å®ƒçš„ pre å€¼. è¿™æ˜¯å› ä¸ºåœ¨ union ç»“æŸå pre å­—å…¸é‡Œå­˜çš„ä¸ä¸€å®šæ˜¯æ¯ä¸ªèŠ‚ç‚¹æœ€æ ¹éƒ¨çš„ç¥–å…ˆ: æˆ‘ä»¬ union çš„æ—¶å€™åªæ˜¯æŠŠä¸€ä¸ªèŠ‚ç‚¹çš„ç¥–å…ˆæŒ‡å‘å¦ä¸€ä¸ªèŠ‚ç‚¹çš„ç¥–å…ˆ, è€Œå¯¹äºèŠ‚ç‚¹ x æœ¬èº«è€Œè¨€, å…¶ç¥–å…ˆ pre[x] ä»ä¸ºåŸæ¥çš„ç¥–å…ˆ, ä»éœ€è¦é€šè¿‡ find æ–¹æ³•è·¯å¾„å‹ç¼©.
- **æ€»ç»“**
  - æ¶‰åŠåˆ°å¹¶æŸ¥é›†çš„é—®é¢˜åŸºæœ¬éƒ½å¯ä»¥å¤ç”¨è¿™ä¸ªä»£ç æ¨¡æ¿, è¿™ä¸ªä¹Ÿæ˜¯æ•´ä¸ªå¹¶æŸ¥é›†ç³»åˆ—çš„æ ¸å¿ƒ. ä¸è¿‡æœ‰æ—¶å€™éœ€è¦é’ˆå¯¹é¢˜ç›®æœ¬èº«åšä¸€äº›æ”¹åŠ¨, åé¢å‡ å¤©æˆ‘ä¼šæ›´æ–°ä¸€äº›ä½¿ç”¨å¹¶æŸ¥é›†å˜ç§çš„é—®é¢˜, å¸Œæœ›å¤§å®¶èƒ½å¤Ÿä»ä¸­æœ‰æ‰€æ”¶è·, é‡åˆ°ç±»ä¼¼çš„é—®é¢˜å¯ä»¥ä¸¾ä¸€åä¸‰.

### å¤æ‚åº¦

- æ—¶é—´å¤æ‚åº¦ O(N+MlogM): å‡è®¾æœ‰ N ä¸ªæ–¹ç¨‹ä»¥åŠ M ä¸ªå˜é‡, éœ€è¦éå†æ–¹ç¨‹ 2 é, ç„¶åå…±éœ€è¦åˆå¹¶ M ä¸ªå˜é‡, æ¯æ¬¡åˆå¹¶æ“ä½œéœ€è¦ logM çš„æ—¶é—´, æ€»å…±å°±æ˜¯ O(N+MlogM)
- ç©ºé—´å¤æ‚åº¦ O(M): pre å­—å…¸ä¸­å­˜ M ä¸ªå…ƒç´ 

### ä»£ç 

#### Python 3

```python
class Solution:
    def equationsPossible(self, equations: List[str]) -> bool:
        # ç»å…¸å¹¶æŸ¥é›†æ¨¡æ¿
        # ç¥–å…ˆå­—å…¸
        pre = {}

        def find(x):
            # æ‰¾xçš„ç¥–å…ˆ
            if x not in pre:
                # ç¥–å…ˆè®¾ä¸ºæœ¬èº«
                pre[x] = x
            elif pre[x] != x:
                # è·¯å¾„å‹ç¼©, æ›´æ–°å½“å‰ç¥–å…ˆåˆ°æ›´ä¸Šé¢çš„ç¥–å…ˆ
                pre[x] = find(pre[x])
            return pre[x]

        def union(x, y):
            # åˆå¹¶xå’Œyåˆ°åŒä¸€é›†åˆ, å³æŠŠxçš„ç¥–å…ˆçš„ç¥–å…ˆæŒ‡å‘yçš„ç¥–å…ˆ
            pre[find(x)] = find(y)

        for e in equations:
            x, y = e[0], e[3]
            if e[1] == '=':
                if x != y:
                    # åªéœ€è¦åˆå¹¶å˜é‡ä¸ç­‰çš„æƒ…å†µ
                    union(x, y)
            else:
                if x == y:
                    # å½“å‰æ˜¯ä¸ç­‰å¼, ä½†æ˜¯ä¸¤è¾¹æ˜¯åŒä¸€ä¸ªå˜é‡, å¿…ç„¶ä¸æ»¡è¶³æ¡ä»¶, ç›´æ¥è¿”å›false
                    return False
        for e in equations:
            x, y = e[0], e[3]
            if e[1] == '!' and find(x) == find(y):
                # å½“å‰æ˜¯ä¸ç­‰å¼, ä½†æ˜¯å‘ç°xå’Œyåœ¨åŒä¸€é›†åˆä¸­, å³ä¹‹å‰åˆ¤æ–­è¿‡xåº”è¯¥ç­‰äºy, æœ‰çŸ›ç›¾, ç›´æ¥è¿”å›false
                return False
        return True
```

#### C++

```cpp
class Solution {
private:
    unordered_map<char, char> pre;
    char find(char x) {
        if (pre.find(x) == pre.end()) {
            pre[x] = x;
        } else if (pre[x] != x) {
            pre[x] = find(pre[x]);
        }
        return pre[x];
    }

    void Union(char x, char y) {
        pre[find(x)] = find(y);
    }
public:
    bool equationsPossible(vector<string>& equations) {
        for (auto& e : equations) {
            char x = e[0];
            char y = e[3];
            if (e[1] == '=') {
                if (x != y) {
                    Union(x, y);
                }
            } else {
                if (x == y) {
                    return false;
                }
            }
        }

        for (auto& e : equations) {
            char x = e[0];
            char y = e[3];
            if (e[1] == '!' && find(x) == find(y)) {
                return false;
            }
        }

        return true;
    }
};
```

---

> å¤§å®¶å¯ä»¥åœ¨ä¸‹é¢è¿™äº›åœ°æ–¹æ‰¾åˆ°æˆ‘~ğŸ˜Š

> [æˆ‘çš„çŸ¥ä¹ä¸“æ ](https://zhuanlan.zhihu.com/c_1242508721932464128)

> [æˆ‘çš„ CSDN](https://me.csdn.net/zjulyx1993)

> [æˆ‘çš„ç®€ä¹¦](https://www.jianshu.com/u/3a17f1fdfd67)

> [æˆ‘çš„ Leetcode](https://leetcode-cn.com/u/suibianfahui/)

> [æˆ‘çš„ç‰›å®¢ç½‘åšå®¢](https://blog.nowcoder.net/zjulyx)

> æˆ‘çš„å…¬ä¼—å·: æ¯æ—¥ç²¾é€‰ç®—æ³•é¢˜, æ¬¢è¿å¤§å®¶æ‰«ç å…³æ³¨~ğŸ˜Š

![æ¯æ—¥ç²¾é€‰ç®—æ³•é¢˜ - å¾®ä¿¡æ‰«ä¸€æ‰«å…³æ³¨æˆ‘](https://mmbiz.qpic.cn/mmbiz_jpg/1KjZicMlYPMgZWmoL4eYcs6UcfmvsetDWME2YJyaCp9oT9z3U573FWENBNhyOByxYI0epew6O37hiaOhdh90QeJg/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)
