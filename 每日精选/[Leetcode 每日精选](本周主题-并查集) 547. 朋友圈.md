> é¢˜ç›®éš¾åº¦: ä¸­ç­‰

> [åŸé¢˜é“¾æ¥](https://leetcode-cn.com/problems/friend-circles/)

> ä»Šå¤©ç»§ç»­æ¥åšå¹¶æŸ¥é›†çš„é—®é¢˜, è¿™é“é¢˜ä»ç„¶æ¯”è¾ƒåŸºç¡€, è€Œä¸”ä¹Ÿæ˜¯ä¸ªæ¯”è¾ƒæ¥è¿‘ç°å®çš„é—®é¢˜äº†. å¤§å®¶åœ¨æˆ‘çš„å…¬ä¼—å·"æ¯æ—¥ç²¾é€‰ç®—æ³•é¢˜"ä¸­çš„èŠå¤©æ¡†ä¸­å›å¤ **å¹¶æŸ¥é›†** å°±èƒ½çœ‹åˆ°è¯¥ç³»åˆ—å½“å‰å·²ç»æ›´æ–°çš„æ–‡ç« äº†

> å¤§å®¶æœ‰ä»€ä¹ˆæƒ³æ³•å»ºè®®å’Œåé¦ˆçš„è¯æ¬¢è¿éšæ—¶äº¤æµ, åŒ…æ‹¬ä½†ä¸é™äºå…¬ä¼—å·èŠå¤©æ¡†/çŸ¥ä¹ç§ä¿¡è¯„è®ºç­‰ç­‰~

## é¢˜ç›®æè¿°

ç­ä¸Šæœ‰ Â NÂ  åå­¦ç”Ÿã€‚å…¶ä¸­æœ‰äº›äººæ˜¯æœ‹å‹ï¼Œæœ‰äº›åˆ™ä¸æ˜¯ã€‚ä»–ä»¬çš„å‹è°Šå…·æœ‰æ˜¯ä¼ é€’æ€§ã€‚å¦‚æœå·²çŸ¥ A æ˜¯ BÂ  çš„æœ‹å‹ï¼ŒB æ˜¯ CÂ  çš„æœ‹å‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è®¤ä¸º A ä¹Ÿæ˜¯ CÂ  çš„æœ‹å‹ã€‚æ‰€è°“çš„æœ‹å‹åœˆï¼Œæ˜¯æŒ‡æ‰€æœ‰æœ‹å‹çš„é›†åˆã€‚

ç»™å®šä¸€ä¸ª Â N \* NÂ  çš„çŸ©é˜µ Â Mï¼Œè¡¨ç¤ºç­çº§ä¸­å­¦ç”Ÿä¹‹é—´çš„æœ‹å‹å…³ç³»ã€‚å¦‚æœ M[i][j] = 1ï¼Œè¡¨ç¤ºå·²çŸ¥ç¬¬ i ä¸ªå’Œ j ä¸ªå­¦ç”Ÿäº’ä¸ºæœ‹å‹å…³ç³»ï¼Œå¦åˆ™ä¸ºä¸çŸ¥é“ã€‚ä½ å¿…é¡»è¾“å‡ºæ‰€æœ‰å­¦ç”Ÿä¸­çš„å·²çŸ¥çš„æœ‹å‹åœˆæ€»æ•°ã€‚

- N åœ¨[1,200]çš„èŒƒå›´å†…ã€‚
- å¯¹äºæ‰€æœ‰å­¦ç”Ÿï¼Œæœ‰ M[i][i] = 1ã€‚
- å¦‚æœæœ‰ M[i][j] = 1ï¼Œåˆ™æœ‰ M[j][i] = 1ã€‚

## é¢˜ç›®æ ·ä¾‹

### ç¤ºä¾‹ 1

#### è¾“å…¥

[[1,1,0],
[1,1,0],
[0,0,1]]

#### è¾“å‡º

2

#### è§£é‡Š

- å·²çŸ¥å­¦ç”Ÿ 0 å’Œå­¦ç”Ÿ 1 äº’ä¸ºæœ‹å‹ï¼Œä»–ä»¬åœ¨ä¸€ä¸ªæœ‹å‹åœˆã€‚
- ç¬¬ 2 ä¸ªå­¦ç”Ÿè‡ªå·±åœ¨ä¸€ä¸ªæœ‹å‹åœˆã€‚æ‰€ä»¥è¿”å› 2ã€‚

### ç¤ºä¾‹ 2

#### è¾“å…¥

[[1,1,0],
[1,1,1],
[0,1,1]]

#### è¾“å‡º

1

#### è§£é‡Š

å·²çŸ¥å­¦ç”Ÿ 0 å’Œå­¦ç”Ÿ 1 äº’ä¸ºæœ‹å‹ï¼Œå­¦ç”Ÿ 1 å’Œå­¦ç”Ÿ 2 äº’ä¸ºæœ‹å‹ï¼Œæ‰€ä»¥å­¦ç”Ÿ 0 å’Œå­¦ç”Ÿ 2 ä¹Ÿæ˜¯æœ‹å‹ï¼Œæ‰€ä»¥ä»–ä»¬ä¸‰ä¸ªåœ¨ä¸€ä¸ªæœ‹å‹åœˆï¼Œè¿”å› 1ã€‚

## é¢˜ç›®æ€è€ƒ

1. æœ‹å‹åœˆçš„ä¸ªæ•°å¯ä»¥ç­‰ä»·äºä»€ä¹ˆå‘¢?

## è§£å†³æ–¹æ¡ˆ

### æ€è·¯

- **åˆ†æ**
  - è¦æ±‚æœ‹å‹åœˆä¸ªæ•°, æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°æ˜¯æœ‹å‹çš„å­¦ç”Ÿ, æŠŠä»–ä»¬å½’ç±»åœ¨ä¸€èµ·å³å¯, æœ€ç»ˆæœ‹å‹åœˆå°±æ˜¯é›†åˆçš„ä¸ªæ•°
- **æ¨å¯¼**
  - ç”±äºæœ‹å‹å…³ç³»æ˜¯ç›¸äº’çš„, å…·æœ‰å¯¹ç§°æ€§, æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦éå†å•æ–¹æœ‹å‹å…³ç³»å³å¯, å³åªéœ€è¦éå† i=>j(i<=j)çš„å…³ç³»
  - ç„¶åå¯¹äºæœ‹å‹å…³ç³», å°†ä¸¤è€… union èµ·æ¥å³å¯
  - æœ€åå†éå†æ‰€æœ‰äººæ‰¾ä»–ä»¬çš„ç¥–å…ˆ (æ³¨æ„æ­¤å¤„ä»ç„¶éœ€è¦è°ƒç”¨ find è€Œä¸æ˜¯ç›´æ¥æ‹¿ pre å­—å…¸ä¸­å­˜çš„ç»“æœ, å…·ä½“åŸå› å‚è§ä¸Šç¯‡æ–‡ç« `[Leetcode æ¯æ—¥ç²¾é€‰](æœ¬å‘¨ä¸»é¢˜-å¹¶æŸ¥é›†) 990. ç­‰å¼æ–¹ç¨‹çš„å¯æ»¡è¶³æ€§`), æŠŠç¥–å…ˆæ”¾åˆ°é›†åˆé‡Œ, æœ€åé›†åˆé•¿åº¦å³ä¸ºæ‰€æ±‚.
- **å®ç°**
  - ä¸‹é¢çš„ä»£ç ä¸­å¯¹æ¯ä¸ªæ­¥éª¤éƒ½æœ‰æ³¨é‡Š, æ–¹ä¾¿å¤§å®¶ç†è§£

### å¤æ‚åº¦

- æ—¶é—´å¤æ‚åº¦ O(N^2logN): éœ€è¦ä¸¤é‡å¾ªç¯, ç„¶åæ¯æ¬¡å¸¦æœ‰è·¯å¾„å‹ç¼©çš„å¹¶æŸ¥é›†çš„æ“ä½œå¤æ‚åº¦ä¸º O(logN)
- ç©ºé—´å¤æ‚åº¦ O(N): pre å­—å…¸ä¸­å­˜ N ä¸ªå…ƒç´ 

### ä»£ç 

#### Python 3

```python
class Solution:
    def findCircleNum(self, M: List[List[int]]) -> int:
        # ç»å…¸å¹¶æŸ¥é›†æ¨¡æ¿
        # ç¥–å…ˆå­—å…¸
        pre = {}

        def find(x):
            # æ‰¾xçš„ç¥–å…ˆ
            if x not in pre:
                # ç¥–å…ˆè®¾ä¸ºæœ¬èº«
                pre[x] = x
            elif pre[x] != x:
                # è·¯å¾„å‹ç¼©, æ›´æ–°å½“å‰ç¥–å…ˆåˆ°æ›´ä¸Šé¢çš„ç¥–å…ˆ
                pre[x] = find(pre[x])
            return pre[x]

        def union(x, y):
            # åˆå¹¶xå’Œyåˆ°åŒä¸€é›†åˆ, å³æŠŠxçš„ç¥–å…ˆçš„ç¥–å…ˆæŒ‡å‘yçš„ç¥–å…ˆ
            pre[find(x)] = find(y)

        n = len(M)
        for i in range(n):
            for j in range(i, n):
                # ç”±äºå¯¹ç§°æ€§, M[j][i]ä¸€å®šä¹Ÿæ˜¯1, æ‰€ä»¥æ­¤å¤„åªéœ€è¦åˆå¹¶iå’Œjå³å¯, jä¸éœ€è¦ä»å¤´å¼€å§‹
                if M[i][j] == 1:
                    union(i, j)
        cntset = set()
        for i in range(n):
            # æ³¨æ„è¿™é‡Œä½¿ç”¨findå¾—åˆ°æ¯ä¸ªèŠ‚ç‚¹çš„æœ€ç»ˆç¥–å…ˆ
            cntset.add(find(i))
        return len(cntset)
```

#### C++

```cpp
class Solution {
public:
    int findCircleNum(vector<vector<int>>& M) {
        unordered_map<int, int> pre;

        function<int(int)> find = [&](int x) {
            if (pre.find(x) == pre.end()) {
                pre[x] = x;
            } else if (pre[x] != x) {
                pre[x] = find(pre[x]);
            }
            return pre[x];
        };

        auto Union = [&](int x, int y) {
            pre[find(x)] = find(y);
        };

        for (int i = 0; i < M.size(); ++i) {
            for (int j = i; j < M.size(); ++j) {
                if (M[i][j]) {
                    Union(i, j);
                }
            }
        }

        unordered_set<int> cntset;
        for (int i = 0; i < M.size(); ++i) {
            cntset.insert(find(i));
        }

        return cntset.size();
    }
};
```

---

> å¤§å®¶å¯ä»¥åœ¨ä¸‹é¢è¿™äº›åœ°æ–¹æ‰¾åˆ°æˆ‘~ğŸ˜Š

> [æˆ‘çš„çŸ¥ä¹ä¸“æ ](https://zhuanlan.zhihu.com/c_1242508721932464128)

> [æˆ‘çš„ CSDN](https://me.csdn.net/zjulyx1993)

> [æˆ‘çš„ Leetcode](https://leetcode-cn.com/u/suibianfahui/)

> [æˆ‘çš„ç‰›å®¢ç½‘åšå®¢](https://blog.nowcoder.net/zjulyx)

> æˆ‘çš„å…¬ä¼—å·: æ¯æ—¥ç²¾é€‰ç®—æ³•é¢˜, æ¬¢è¿å¤§å®¶æ‰«ç å…³æ³¨~ğŸ˜Š

![æ¯æ—¥ç²¾é€‰ç®—æ³•é¢˜ - å¾®ä¿¡æ‰«ä¸€æ‰«å…³æ³¨æˆ‘](https://mmbiz.qpic.cn/mmbiz_jpg/1KjZicMlYPMgZWmoL4eYcs6UcfmvsetDWME2YJyaCp9oT9z3U573FWENBNhyOByxYI0epew6O37hiaOhdh90QeJg/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)
