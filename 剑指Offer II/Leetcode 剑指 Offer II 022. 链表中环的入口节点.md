> é¢˜ç›®éš¾åº¦: ä¸­ç­‰

> [åŸé¢˜é“¾æ¥](https://leetcode.cn/problems/c32eOV)

> ä»Šå¤©ç»§ç»­æ›´æ–° Leetcode çš„å‰‘æŒ‡ Offerï¼ˆä¸“é¡¹çªå‡»ç‰ˆï¼‰ç³»åˆ—, å¤§å®¶åœ¨å…¬ä¼—å· **ç®—æ³•ç²¾é€‰** é‡Œå›å¤ `å‰‘æŒ‡offer2` å°±èƒ½çœ‹åˆ°è¯¥ç³»åˆ—å½“å‰è¿è½½çš„æ‰€æœ‰æ–‡ç« äº†, è®°å¾—å…³æ³¨å“¦~

## é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œè¿”å›é“¾è¡¨å¼€å§‹å…¥ç¯çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚ ä»é“¾è¡¨çš„å¤´èŠ‚ç‚¹å¼€å§‹æ²¿ç€ next æŒ‡é’ˆè¿›å…¥ç¯çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¸ºç¯çš„å…¥å£èŠ‚ç‚¹ã€‚å¦‚æœé“¾è¡¨æ— ç¯ï¼Œåˆ™è¿”å› Â nullã€‚

ä¸ºäº†è¡¨ç¤ºç»™å®šé“¾è¡¨ä¸­çš„ç¯ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•´æ•° pos æ¥è¡¨ç¤ºé“¾è¡¨å°¾è¿æ¥åˆ°é“¾è¡¨ä¸­çš„ä½ç½®ï¼ˆç´¢å¼•ä» 0 å¼€å§‹ï¼‰ã€‚ å¦‚æœ pos æ˜¯ -1ï¼Œåˆ™åœ¨è¯¥é“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚æ³¨æ„ï¼Œpos ä»…ä»…æ˜¯ç”¨äºæ ‡è¯†ç¯çš„æƒ…å†µï¼Œå¹¶ä¸ä¼šä½œä¸ºå‚æ•°ä¼ é€’åˆ°å‡½æ•°ä¸­ã€‚

è¯´æ˜ï¼šä¸å…è®¸ä¿®æ”¹ç»™å®šçš„é“¾è¡¨ã€‚

### ç¤ºä¾‹ 1ï¼š

![](https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist.png)

- è¾“å…¥ï¼šhead = [3,2,0,-4], pos = 1
- è¾“å‡ºï¼štail connects to node index 1
- è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬äºŒä¸ªèŠ‚ç‚¹ã€‚

### ç¤ºä¾‹ 2ï¼š

![](https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist_test2.png)

- è¾“å…¥ï¼šhead = [1,2], pos = 0
- è¾“å‡ºï¼štail connects to node index 0
- è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚

### ç¤ºä¾‹ 3ï¼š

![](https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist_test3.png)

- è¾“å…¥ï¼šhead = [1], pos = -1
- è¾“å‡ºï¼šno cycle
- è§£é‡Šï¼šé“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚

### æç¤ºï¼š

- é“¾è¡¨ä¸­èŠ‚ç‚¹çš„æ•°ç›®èŒƒå›´åœ¨èŒƒå›´ [0, 10^4] å†…
- -10^5 <= Node.val <= 10^5
- pos çš„å€¼ä¸º -1 æˆ–è€…é“¾è¡¨ä¸­çš„ä¸€ä¸ªæœ‰æ•ˆç´¢å¼•

## é¢˜ç›®æ€è€ƒ

1. å¦‚ä½•ä½¿ç”¨ O(1) ç©ºé—´è§£å†³æ­¤é¢˜?

## è§£å†³æ–¹æ¡ˆ

#### æ€è·¯

- ä¸€ä¸ªæ¯”è¾ƒå®¹æ˜“æƒ³åˆ°çš„æ€è·¯å°†èŠ‚ç‚¹å­˜åˆ°é›†åˆé‡Œé¢, ç„¶åå¦‚æœéå†åˆ°å·²ç»åœ¨é›†åˆçš„èŠ‚ç‚¹, å°±è¯´æ˜å­˜åœ¨ç¯, ä½†è¿™æ ·ä½¿ç”¨äº†é¢å¤–ç©ºé—´, å¦‚ä½•åšåˆ°ä¸ä½¿ç”¨é¢å¤–ç©ºé—´å‘¢?
- å°†é“¾è¡¨æƒ³è±¡æˆä¸€ä¸ªè·‘é“, å…¶ä¸­å±äºç¯çš„éƒ¨åˆ†æ˜¯åœ†å½¢è·‘é“, ä¸å±äºç¯çš„éƒ¨åˆ†æ˜¯ç›´çº¿è·‘é“. å‡è®¾æœ‰ä¸¤ä¸ªäººåŒæ—¶ä»è·‘é“èµ·ç‚¹å‡ºå‘ä¸”é€Ÿåº¦ä¸åŒ, ä»€ä¹ˆæƒ…å†µä¸‹ä¸¤äººä¼šå†æ¬¡ç›¸é‡å‘¢?
- å¦‚æœè·‘é“æ²¡æœ‰ç¯, é‚£ä¹ˆæ…¢çš„é‚£ä¸ªäººæ°¸è¿œè¿½ä¸ä¸Šå¿«çš„, è‡ªç„¶ä¸ä¼šå†æ¬¡ç›¸é‡; ä½†å¦‚æœæœ‰ç¯, é‚£ä¹ˆæ€»æœ‰ä¸€ä¸ªæ—¶åˆ»ä¸¤ä¸ªäººä¼šåœ¨ç¯çš„æŸä¸ªç‚¹ç›¸é‡, æ­¤æ—¶å¿«çš„é‚£ä¸ªäººé¢†å…ˆè‹¥å¹²åœˆ
- æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¿«æ…¢æŒ‡é’ˆçš„æ–¹æ³•, **å¿«æŒ‡é’ˆæ¯æ¬¡èµ°ä¸¤æ­¥, æ…¢æŒ‡é’ˆæ¯æ¬¡èµ°ä¸€æ­¥, å¦‚æœä¸¤ä¸ªæŒ‡é’ˆèƒ½ç›¸é‡, åˆ™è¯´æ˜å­˜åœ¨ç¯; å¦åˆ™å¦‚æœå¿«æŒ‡é’ˆå…ˆåˆ°è¾¾ç»ˆç‚¹(å³ç©ºèŠ‚ç‚¹), åˆ™è¯´æ˜æ— ç¯**
- æ¥ä¸‹æ¥è€ƒè™‘å¦‚ä½•æ±‚ç¯çš„èµ·ç‚¹:
  - æ‰¾åˆ°äº¤ç‚¹å, è®¾ head åˆ°ç¯çš„èµ·ç‚¹çš„è·ç¦»ä¸º x, ç¯çš„èµ·ç‚¹åˆ°ä¸¤ä¸ªæŒ‡é’ˆäº¤ç‚¹çš„è·ç¦»ä¸º y, äº¤ç‚¹ç»§ç»­å¾€åèµ°åˆ°ç¯çš„èµ·ç‚¹çš„è·ç¦»ä¸º z, æ…¢æŒ‡é’ˆè¾¾åˆ°äº¤ç‚¹æ—¶èµ°äº† m åœˆå®Œæ•´çš„ç¯, å¿«æŒ‡é’ˆè¾¾åˆ°äº¤ç‚¹æ—¶èµ°äº† n åœˆå®Œæ•´çš„ç¯
  - æ˜¾ç„¶æœ‰ `2(x+y+m(y+z)) = x+y+n(y+z)`, è¿›è€Œå¾—åˆ°`x=(n-2m-1)(y+z) + z`, ä¹Ÿå°±æ˜¯è¯´, x ç›¸å½“äº z åŠ ä¸Šè‹¥å¹²åœˆå®Œæ•´çš„ç¯çš„è·ç¦».
  - æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†æŒ‡é’ˆ a é‡æ–°æŒ‡å‘é“¾è¡¨å¤´, æŒ‡é’ˆ b ä¿æŒåœ¨äº¤ç‚¹ä¸å˜, ç„¶åä¸¤æŒ‡é’ˆæ¯æ¬¡å¾€å‰èµ°ä¸€æ­¥, é‚£ä¹ˆå½“ a èµ°äº† x æ­¥åˆ°è¾¾ç¯è·¯èµ·ç‚¹æ—¶, b å¿…å®šèµ°äº† z åŠ è‹¥å¹²åœˆå®Œæ•´çš„ç¯çš„è·ç¦», æ°å¥½ä¹Ÿåˆ°äº†ç¯çš„èµ·ç‚¹, ä¹Ÿå°±æ˜¯ä¸¤æŒ‡é’ˆé‡æ–°å‡ºå‘åç¬¬ä¸€æ¬¡ç›¸é‡çš„ä½ç½®, è¿™æ ·å°±å¾—åˆ°äº†é¢˜ç›®ç­”æ¡ˆ

#### å¤æ‚åº¦

- æ—¶é—´å¤æ‚åº¦ O(N): åªéœ€è¦éå†æ¯ä¸ªèŠ‚ç‚¹å¸¸æ•°é
- ç©ºé—´å¤æ‚åº¦ O(1): åªä½¿ç”¨äº†å‡ ä¸ªå¸¸æ•°ç©ºé—´çš„å˜é‡

#### ä»£ç 

```python
class Solution:
    def detectCycle(self, head: ListNode) -> ListNode:
        # ç»å…¸å¿«æ…¢æŒ‡é’ˆ
        # æ³¨æ„ç¯è·¯èµ·ç‚¹çš„æ±‚æ³•:
        #   æ‰¾åˆ°ç›¸ç­‰çš„èŠ‚ç‚¹å
        #   å…¶ä¸­ä¸€ä¸ªæŒ‡é’ˆé‡æ–°å˜æˆhead
        #   ç„¶åå’Œå¦ä¸€ä¸ªæŒ‡é’ˆæ¯æ¬¡+1
        #   ç›´åˆ°å†æ¬¡ç›¸äº¤, è¯¥ç‚¹å³ä¸ºç¯è·¯èµ·ç‚¹
        # è¯æ˜:
        #   è®¾headåˆ°èµ·ç‚¹ä¸ºx, èµ·ç‚¹åˆ°ç¬¬ä¸€æ¬¡äº¤ç‚¹ä¸ºy, ç¬¬ä¸€æ¬¡äº¤ç‚¹åˆ°ç¯èµ·ç‚¹ä¸ºz
        #   é‚£ä¹ˆ2(x+y+m(y+z)) = x+y+n(y+z) (nå’Œmæ˜¯å¿«æ…¢æŒ‡é’ˆç»è¿‡ç¯çš„æ¬¡æ•°)
        #   é‚£ä¹ˆx+y = (n-2m)(y+z) (n-2m>0)
        #   é‚£ä¹ˆx = (n-2m-1)(y+z) + z (n-2m-1>=0)
        #   å³æ–°çš„å¤´æŒ‡é’ˆç»è¿‡xæ­¥å’ŒåŸæ¥åœ¨ç¬¬ä¸€ä¸ªäº¤ç‚¹çš„æŒ‡é’ˆç»è¿‡xæ­¥(å¯èƒ½åˆèµ°äº†n-2m-1ä¸ªç¯, åŠ ä¸Šäº¤ç‚¹åˆ°èµ·ç‚¹çš„è·ç¦»z)æ‰€å¤„çš„ä½ç½®ä¸€å®šéƒ½æ˜¯ç¯è·¯èµ·ç‚¹
        slow, fast = head, head
        while fast:
            slow = slow.next
            fast = fast.next
            if fast:
                fast = fast.next
            if not fast:
                # æ²¡æœ‰ç¯
                return None
            if fast == slow:
                break
        slow = head
        while slow != fast:
            slow = slow.next
            fast = fast.next
        return slow
```

---

> å¤§å®¶å¯ä»¥åœ¨ä¸‹é¢è¿™äº›åœ°æ–¹æ‰¾åˆ°æˆ‘~ğŸ˜Š

> [æˆ‘çš„ GitHub](https://github.com/zjulyx)

> [æˆ‘çš„ Leetcode](https://leetcode-cn.com/u/suibianfahui/)

> [æˆ‘çš„ CSDN](https://me.csdn.net/zjulyx1993)

> [æˆ‘çš„çŸ¥ä¹ä¸“æ ](https://zhuanlan.zhihu.com/c_1242508721932464128)

> [æˆ‘çš„å¤´æ¡å·](https://www.toutiao.com/c/user/1090304683804520/#mid=1671643017345028)

> [æˆ‘çš„ç‰›å®¢ç½‘åšå®¢](https://blog.nowcoder.net/zjulyx)

> æˆ‘çš„å…¬ä¼—å·: [ç®—æ³•ç²¾é€‰](https://mp.weixin.qq.com/s?__biz=MzA5MDk1MjI5MA==&mid=2247484158&idx=1&sn=90176bac32cf7af40e4074c721fd8a95&chksm=900285f3a7750ce5a068c9c9773781461819633f2fd60533732637ec9520c908371ebc218d49&scene=178&cur_album_id=1386231241346859009#rd), æ¬¢è¿å¤§å®¶æ‰«ç å…³æ³¨~ğŸ˜Š

![ç®—æ³•ç²¾é€‰ - å¾®ä¿¡æ‰«ä¸€æ‰«å…³æ³¨æˆ‘](https://pic1.zhimg.com/80/v2-7c988a7b35886df51596ef23616764ac_1440w.jpg)
