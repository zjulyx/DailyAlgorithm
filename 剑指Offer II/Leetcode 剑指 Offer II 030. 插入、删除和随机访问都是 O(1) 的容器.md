> é¢˜ç›®éš¾åº¦: ä¸­ç­‰

> [åŸé¢˜é“¾æ¥](https://leetcode.cn/problems/FortPu/)

> ä»Šå¤©ç»§ç»­æ›´æ–° Leetcode çš„å‰‘æŒ‡ Offerï¼ˆä¸“é¡¹çªå‡»ç‰ˆï¼‰ç³»åˆ—, å¤§å®¶åœ¨å…¬ä¼—å· **ç®—æ³•ç²¾é€‰** é‡Œå›å¤ `å‰‘æŒ‡offer2` å°±èƒ½çœ‹åˆ°è¯¥ç³»åˆ—å½“å‰è¿è½½çš„æ‰€æœ‰æ–‡ç« äº†, è®°å¾—å…³æ³¨å“¦~

## é¢˜ç›®æè¿°

è®¾è®¡ä¸€ä¸ªæ”¯æŒåœ¨å¹³å‡ æ—¶é—´å¤æ‚åº¦ O(1) ä¸‹ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œçš„æ•°æ®ç»“æ„ï¼š

- insert(val)ï¼šå½“å…ƒç´  val ä¸å­˜åœ¨æ—¶è¿”å› true ï¼Œå¹¶å‘é›†åˆä¸­æ’å…¥è¯¥é¡¹ï¼Œå¦åˆ™è¿”å› false ã€‚
- remove(val)ï¼šå½“å…ƒç´  val å­˜åœ¨æ—¶è¿”å› true ï¼Œå¹¶ä»é›†åˆä¸­ç§»é™¤è¯¥é¡¹ï¼Œå¦åˆ™è¿”å› false ã€‚
- getRandomï¼šéšæœºè¿”å›ç°æœ‰é›†åˆä¸­çš„ä¸€é¡¹ã€‚æ¯ä¸ªå…ƒç´ åº”è¯¥æœ‰ ç›¸åŒçš„æ¦‚ç‡ è¢«è¿”å›ã€‚

### ç¤ºä¾‹ :

- è¾“å…¥: inputs = ["RandomizedSet", "insert", "remove", "insert", "getRandom", "remove", "insert", "getRandom"]
  [[], [1], [2], [2], [], [1], [2], []]
- è¾“å‡º: [null, true, false, true, 2, true, false, 2]
- è§£é‡Š:

```java
RandomizedSet randomSet = new RandomizedSet(); // åˆå§‹åŒ–ä¸€ä¸ªç©ºçš„é›†åˆ
randomSet.insert(1); // å‘é›†åˆä¸­æ’å…¥ 1 ï¼Œ è¿”å› true è¡¨ç¤º 1 è¢«æˆåŠŸåœ°æ’å…¥
randomSet.remove(2); // è¿”å› falseï¼Œè¡¨ç¤ºé›†åˆä¸­ä¸å­˜åœ¨ 2
randomSet.insert(2); // å‘é›†åˆä¸­æ’å…¥ 2 è¿”å› true ï¼Œé›†åˆç°åœ¨åŒ…å« [1,2]
randomSet.getRandom(); // getRandom åº”éšæœºè¿”å› 1 æˆ– 2
randomSet.remove(1); // ä»é›†åˆä¸­ç§»é™¤ 1 è¿”å› true ã€‚é›†åˆç°åœ¨åŒ…å« [2]
randomSet.insert(2); // 2 å·²åœ¨é›†åˆä¸­ï¼Œæ‰€ä»¥è¿”å› false
randomSet.getRandom(); // ç”±äº 2 æ˜¯é›†åˆä¸­å”¯ä¸€çš„æ•°å­—ï¼ŒgetRandom æ€»æ˜¯è¿”å› 2
```

### æç¤ºï¼š

- -2^31 <= val <= 2^31 - 1
- æœ€å¤šè¿›è¡Œ 2 \* 10^5 æ¬¡ insert ï¼Œ remove å’Œ getRandom æ–¹æ³•è°ƒç”¨
- å½“è°ƒç”¨ getRandom æ–¹æ³•æ—¶ï¼Œé›†åˆä¸­è‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ 

## é¢˜ç›®æ€è€ƒ

1. éœ€è¦ç”¨åˆ°å“ªäº›æ•°æ®ç»“æ„?

## è§£å†³æ–¹æ¡ˆ

#### æ€è·¯

- åˆ†æé¢˜ç›®, æœ€å®¹æ˜“æƒ³åˆ°çš„æ€è·¯å°±æ˜¯åˆ©ç”¨ set, è¿™æ ·æ’å…¥å’Œåˆ é™¤éƒ½æ˜¯ O(1) æ—¶é—´
- ä½† set çš„é—®é¢˜æ˜¯ getRandom æ— æ³•åšåˆ° O(1), å¿…é¡»å¾—å…ˆè½¬æˆæ•°ç»„, ç„¶åå–å…¶éšæœºä¸‹æ ‡æ‰è¡Œ
- è¦æƒ³ getRandom æ“ä½œæ˜¯ O(1) æ—¶é—´, æˆ‘ä»¬å¿…é¡»ç»´æŠ¤ä¸€ä¸ªæ•°ç»„, ä½†å…¶åˆ é™¤å…ƒç´ ä¸æ˜¯ O(1), å¦‚ä½•è§£å†³å‘¢?
- å›é¡¾æ•°ç»„çš„æ€§è´¨, å…¶åˆ é™¤æœ«å°¾å…ƒç´ åªéœ€è¦ O(1) æ—¶é—´, æˆ‘ä»¬å¦‚æœå¯ä»¥å°†åˆ é™¤ä»»æ„å…ƒç´ è½¬æ¢æˆåˆ é™¤æœ«å°¾å…ƒç´ , å°±èƒ½åšåˆ°æ‰€æœ‰æ“ä½œéƒ½æ˜¯ O(1) äº†, è¿™è¦å¦‚ä½•å®ç°å‘¢?
- æˆ‘ä»¬å¦‚æœèƒ½å¤ŸçŸ¥é“ä»»æ„å…ƒç´ çš„ä¸‹æ ‡, é‚£ä¹ˆåœ¨åˆ é™¤å®ƒæ—¶, å¯ä»¥å°†å®ƒä¸æœ«å°¾å…ƒç´ è¿›è¡Œäº¤æ¢, è¿™æ ·å°±è½¬æ¢æˆäº†åˆ é™¤æœ«å°¾å…ƒç´ 
- ä¸éš¾æƒ³åˆ°æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå…ƒç´ åˆ°ä¸‹æ ‡çš„æ˜ å°„å­—å…¸æ¥å®ç°, ç„¶ååœ¨æ’å…¥å’Œåˆ é™¤æ—¶å¢åŠ ä¸€äº›é¢å¤–çš„æ“ä½œæ¥æ›´æ–°è¯¥å­—å…¸
- æ’å…¥æ—¶, æˆ‘ä»¬å…ˆåˆ©ç”¨è¯¥å­—å…¸åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨ (O(1)), ä¸å­˜åœ¨æ—¶åªéœ€è¦å°†å…ƒç´ æ’å…¥åˆ°æ•°ç»„æœ«å°¾ (O(1)), ç„¶ååœ¨å­—å…¸ä¸­å¢åŠ ä¸€é¡¹, å³å®ƒåˆ°æ–°çš„æœ«å°¾ä¸‹æ ‡çš„æ˜ å°„ (O(1))
- åˆ é™¤æ—¶, åŒæ ·å…ˆåˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨äºå­—å…¸ä¸­ (O(1)), å­˜åœ¨æ—¶æ‹¿åˆ°å…ƒç´ å¯¹åº”ä¸‹æ ‡ (O(1)), å¦‚æœè¯¥ä¸‹æ ‡ä¸æ˜¯æœ«å°¾, åˆ™å°†å…¶ä¸æœ«å°¾å…ƒç´ äº¤æ¢ (O(1)), åŒæ—¶æ›´æ–°æ˜ å°„å­—å…¸ ((O(1))), æœ€åå†ç§»é™¤æ•°ç»„çš„æœ«å°¾å…ƒç´  (O(1)), ä»¥åŠå­—å…¸ä¸­è¯¥å…ƒç´ çš„æ˜ å°„å…³ç³»å³å¯ ((O(1)))
- å–éšæœºé¡¹æ—¶, åˆ©ç”¨ random åº“ç›´æ¥å¾—åˆ°ä¸€ä¸ªæ•°ç»„èŒƒå›´å†…çš„ä¸‹æ ‡, å¹¶è¿”å›æ•°ç»„å¯¹åº”å…ƒç´ å³å¯ (O(1))
- ç»¼ä¸Šæ‰€è¿°, æ‰€æœ‰æ“ä½œéƒ½åªéœ€è¦ O(1) æ—¶é—´
- ä¸‹é¢ä»£ç æœ‰è¯¦ç»†çš„æ³¨é‡Š, æ–¹ä¾¿å¤§å®¶ç†è§£

#### å¤æ‚åº¦

- æ—¶é—´å¤æ‚åº¦ O(1): æ¯ç§æ“ä½œéƒ½åªéœ€è¦å¸¸æ•°æ—¶é—´
- ç©ºé—´å¤æ‚åº¦ O(N): æ•°ç»„å’Œå­—å…¸å„éœ€è¦ O(N) ç©ºé—´

#### ä»£ç 

```python
class RandomizedSet:
    def __init__(self):
        """
        Initialize your data structure here.
        """
        # åˆå§‹åŒ–æ•°ç»„(ç”¨äºå–éšæœºæ•°)å’Œv2iå­—å…¸(ç”¨äºç»´æŠ¤å€¼å’Œä¸‹æ ‡çš„å¯¹åº”å…³ç³»)
        self.arr = []
        self.v2i = {}

    def insert(self, val: int) -> bool:
        """
        Inserts a value to the set. Returns true if the set did not already contain the specified element.
        """
        if val in self.v2i:
            # è¯¥å€¼å·²å­˜åœ¨, ä¸è¿›è¡Œæ“ä½œ
            return False
        # è¿½åŠ åˆ°æ•°ç»„æœ«å°¾, å¹¶æ›´æ–°v2iå­—å…¸
        self.arr.append(val)
        self.v2i[val] = len(self.arr) - 1
        return True

    def remove(self, val: int) -> bool:
        """
        Removes a value from the set. Returns true if the set contained the specified element.
        """
        if val in self.v2i:
            # è¯¥å€¼å­˜åœ¨, æ‰¾åˆ°å®ƒçš„ä¸‹æ ‡
            i = self.v2i[val]
            end = len(self.arr) - 1
            if i != end:
                # å¦‚æœå¾…ç§»é™¤ä¸‹æ ‡ä¸æ˜¯æœ«å°¾, åˆ™å°†å®ƒå’Œæœ«å°¾ä¸‹æ ‡äº¤æ¢, å¹¶æ›´æ–°v2iå­—å…¸
                self.arr[i], self.arr[end] = self.arr[end], self.arr[i]
                self.v2i[self.arr[i]] = i
            # è¿™æ ·åªéœ€è¦O(1)æ—¶é—´ç§»é™¤æ•°ç»„æœ«å°¾å…ƒç´ å’Œv2iå­—å…¸å¯¹åº”é¡¹å³å¯
            self.arr.pop()
            del self.v2i[val]
            return True
        return False

    def getRandom(self) -> int:
        """
        Get a random element from the set.
        """
        # ä½¿ç”¨randrangeè·å–[0,n)çš„éšæœºä¸‹æ ‡
        i = random.randrange(len(self.arr))
        return self.arr[i]
```

---

> å¤§å®¶å¯ä»¥åœ¨ä¸‹é¢è¿™äº›åœ°æ–¹æ‰¾åˆ°æˆ‘~ğŸ˜Š

> [æˆ‘çš„ GitHub](https://github.com/zjulyx)

> [æˆ‘çš„ Leetcode](https://leetcode-cn.com/u/suibianfahui/)

> [æˆ‘çš„ CSDN](https://me.csdn.net/zjulyx1993)

> [æˆ‘çš„çŸ¥ä¹ä¸“æ ](https://zhuanlan.zhihu.com/c_1242508721932464128)

> [æˆ‘çš„å¤´æ¡å·](https://www.toutiao.com/c/user/1090304683804520/#mid=1671643017345028)

> [æˆ‘çš„ç‰›å®¢ç½‘åšå®¢](https://blog.nowcoder.net/zjulyx)

> æˆ‘çš„å…¬ä¼—å·: [ç®—æ³•ç²¾é€‰](https://mp.weixin.qq.com/s?__biz=MzA5MDk1MjI5MA==&mid=2247484158&idx=1&sn=90176bac32cf7af40e4074c721fd8a95&chksm=900285f3a7750ce5a068c9c9773781461819633f2fd60533732637ec9520c908371ebc218d49&scene=178&cur_album_id=1386231241346859009#rd), æ¬¢è¿å¤§å®¶æ‰«ç å…³æ³¨~ğŸ˜Š

![ç®—æ³•ç²¾é€‰ - å¾®ä¿¡æ‰«ä¸€æ‰«å…³æ³¨æˆ‘](https://pic1.zhimg.com/80/v2-7c988a7b35886df51596ef23616764ac_1440w.jpg)
