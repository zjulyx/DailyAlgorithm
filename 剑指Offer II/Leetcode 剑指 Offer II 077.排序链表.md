> é¢˜ç›®éš¾åº¦: ä¸­ç­‰

> [åŸé¢˜é“¾æ¥](https://leetcode.cn/problems/7WHec2/)

> ä»Šå¤©ç»§ç»­æ›´æ–° Leetcode çš„å‰‘æŒ‡ Offerï¼ˆä¸“é¡¹çªå‡»ç‰ˆï¼‰ç³»åˆ—, å¤§å®¶åœ¨å…¬ä¼—å· **ç®—æ³•ç²¾é€‰** é‡Œå›å¤ `å‰‘æŒ‡offer2` å°±èƒ½çœ‹åˆ°è¯¥ç³»åˆ—å½“å‰è¿è½½çš„æ‰€æœ‰æ–‡ç« äº†, è®°å¾—å…³æ³¨å“¦~

## é¢˜ç›®æè¿°

ç»™å®šé“¾è¡¨çš„å¤´ç»“ç‚¹ head ï¼Œè¯·å°†å…¶æŒ‰ å‡åº æ’åˆ—å¹¶è¿”å› æ’åºåçš„é“¾è¡¨ ã€‚

### ç¤ºä¾‹ 1ï¼š

![](https://assets.leetcode.com/uploads/2020/09/14/sort_list_1.jpg)

- è¾“å…¥ï¼šhead = [4,2,1,3]
- è¾“å‡ºï¼š[1,2,3,4]

### ç¤ºä¾‹ 2ï¼š

![](https://assets.leetcode.com/uploads/2020/09/14/sort_list_2.jpg)

- è¾“å…¥ï¼šhead = [-1,5,3,4,0]
- è¾“å‡ºï¼š[-1,0,3,4,5]

### ç¤ºä¾‹ 3ï¼š

- è¾“å…¥ï¼šhead = []
- è¾“å‡ºï¼š[]

### æç¤ºï¼š

- é“¾è¡¨ä¸­èŠ‚ç‚¹çš„æ•°ç›®åœ¨èŒƒå›´ [0, 5 * 10^4] å†…
- -10^5 <= Node.val <= 10^5

è¿›é˜¶ï¼šä½ å¯ä»¥åœ¨ O(n log n) æ—¶é—´å¤æ‚åº¦å’Œå¸¸æ•°çº§ç©ºé—´å¤æ‚åº¦ä¸‹ï¼Œå¯¹é“¾è¡¨è¿›è¡Œæ’åºå—ï¼Ÿ

## é¢˜ç›®æ€è€ƒ

1. å¦‚ä½•åšåˆ° O(n log n) æ—¶é—´å¤æ‚åº¦å’Œå¸¸æ•°çº§ç©ºé—´å¤æ‚åº¦?

## è§£å†³æ–¹æ¡ˆ

#### æ€è·¯

- åˆ†æé¢˜ç›®, ä¸€ä¸ªå¾ˆå®¹æ˜“æƒ³åˆ°çš„æ€è·¯å°±æ˜¯å°†é“¾è¡¨æ¯ä¸ªèŠ‚ç‚¹å­˜åˆ°ä¸€ä¸ªæ•°ç»„ä¸­, ç„¶åä½¿ç”¨è‡ªå®šä¹‰æ’åº, å¯¹æ•°ç»„æŒ‰ç…§èŠ‚ç‚¹çš„å€¼ä»å°åˆ°å¤§æ’åº, å†ä¾æ¬¡è¿èµ·æ¥å³å¯
- ä¸è¿‡è¿™æ ·è™½è¯´æ—¶é—´å¤æ‚åº¦å¯ä»¥åšåˆ° O(NlogN), ä½†ä½¿ç”¨äº†é¢å¤–ç©ºé—´, ä¸æ»¡è¶³è¿›é˜¶è¦æ±‚, å¦‚ä½•ä¼˜åŒ–å‘¢?
- è¦æƒ³åšåˆ°å¸¸æ•°çº§ç©ºé—´å¤æ‚åº¦æ’åº, é¦–å…ˆå°±ä¸èƒ½é‡‡ç”¨é€’å½’, å› ä¸ºé€’å½’æœ‰é¢å¤–é€’å½’æ ˆçš„ç©ºé—´æ¶ˆè€—
- å¦å¤–é¢˜ç›®ç»™çš„æ˜¯å•å‘é“¾è¡¨, ä¸å¥½ä»åå¾€å‰éå†, æ‰€ä»¥ç»å…¸çš„å¿«é€Ÿæ’åºåœ¨è¿™é‡Œä¹Ÿä¸é€‚ç”¨, å¦‚æœé¢å¤–å¢åŠ å‘å‰çš„è¿æ¥, åˆéœ€è¦é¢å¤–ç©ºé—´
- å¸¸è§çš„ O(NlogN)æ’åºè¿˜æœ‰å½’å¹¶æ’åº, è™½ç„¶é€’å½’å½’å¹¶çš„å®ç°æ–¹å¼æ¯”è¾ƒç»å…¸, ä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨è¿­ä»£çš„æ–¹å¼å®ç°, è¿™æ ·å°±å¯ä»¥åšåˆ°å¸¸æ•°çº§ç©ºé—´å¤æ‚åº¦
- å…·ä½“æ€è·¯å°±æ˜¯å…ˆå°†ç›¸é‚»çš„å•ä¸ªèŠ‚ç‚¹è¿›è¡Œå½’å¹¶, ç„¶åå†å°† 2 ä¸ªèŠ‚ç‚¹ä½œä¸ºæ•´ä½“, å°†ç›¸é‚»éƒ¨åˆ†å½’å¹¶, ç„¶åæ˜¯ 4 ä¸ª, 8 ä¸ª, ä»¥æ­¤ç±»æ¨, æœ€ç»ˆå®ç°å…¨éƒ¨èŠ‚ç‚¹çš„æ’åº
- ä¸¾ä¸ªä¾‹å­, å¯¹äºé“¾è¡¨`1->5->4->3->0->2`
  1. ç¬¬ä¸€æ­¥, å¯¹ç›¸é‚»èŠ‚ç‚¹ä»å°åˆ°å¤§å½’å¹¶æ’åº, å³ 1 å’Œ 5 å½’å¹¶, 4 å’Œ 3 å½’å¹¶, 0 å’Œ 2 å½’å¹¶, å¾—åˆ°`1->5->3->4->0->2`
  2. ç¬¬äºŒæ­¥, å¯¹ç›¸é‚»ä¸¤ä¸ªèŠ‚ç‚¹ä»å°åˆ°å¤§å½’å¹¶æ’åº, å³`1->5`å’Œ`3->4`å½’å¹¶, `0->2`ä¸å˜, å¾—åˆ°`1->3->4->5->0->2`
  3. ç¬¬äºŒæ­¥, å¯¹ç›¸é‚»å››ä¸ªèŠ‚ç‚¹ä»å°åˆ°å¤§å½’å¹¶æ’åº, å³`1->3->4->5`å’Œ`0->2`å½’å¹¶, å¾—åˆ°`0->1->2->3->4->5`
- è¿™æ ·åªéœ€è¦ logN æ¬¡å½’å¹¶, ç„¶åæ¯æ¬¡å½’å¹¶åªéœ€è¦éå†æ¯ä¸ªèŠ‚ç‚¹å¸¸æ•°æ¬¡, æ€»ä½“æ—¶é—´å¤æ‚åº¦æ˜¯ O(NlogN), ä¸”æ²¡æœ‰ä½¿ç”¨é¢å¤–ç©ºé—´
- å…·ä½“å®ç°æ–¹é¢, æˆ‘ä»¬éœ€è¦è®°å½•é“¾è¡¨æ€»é•¿åº¦å’Œå½“å‰å½’å¹¶éƒ¨åˆ†çš„é•¿åº¦
- ç„¶åé’ˆå¯¹æ¯ä¸ªå½’å¹¶é•¿åº¦éå†æ•´ä¸ªé“¾è¡¨, åˆ†åˆ«å¾—åˆ°å½“å‰å¾…å½’å¹¶çš„å·¦å³éƒ¨åˆ†, å½’å¹¶åå†ç»§ç»­ä¸‹ä¸ªå·¦å³éƒ¨åˆ†çš„å½’å¹¶, ç›´åˆ°è¾¾åˆ°æœ«å°¾
- æœ€ç»ˆå½“å½’å¹¶é•¿åº¦å¤§äºç­‰äºæ€»é•¿åº¦æ—¶, è¯´æ˜æ•´ä¸ªé“¾è¡¨å·²ç»æ’åºå¥½äº†, è¿”å›é“¾è¡¨å¤´å³å¯
- å¦å¤–æ³¨æ„åœ¨éå†è¿‡ç¨‹ä¸­éœ€è¦å¤„ç†å¥½èŠ‚ç‚¹çš„è¿æ¥å…³ç³», é¿å…å¯¼è‡´æ— é™å¾ªç¯
- ä¸‹é¢ä»£ç ç»™å‡ºäº†æ¯ä¸€æ­¥è¯¦ç»†çš„æ³¨é‡Š, å¤§å®¶å¯ä»¥ç»“åˆä»£ç å’Œæ³¨é‡Šæ¥ç†è§£

#### å¤æ‚åº¦

- æ—¶é—´å¤æ‚åº¦ O(NlogN): æ¯æ¬¡å½’å¹¶æ’åºçš„é•¿åº¦éƒ½æ˜¯ä¸Šæ¬¡é•¿åº¦ä¹˜ä»¥ 2, æ‰€ä»¥ä¸€å…±åªéœ€è¦å½’å¹¶ logN æ¬¡, ç„¶åæ¯æ¬¡å½’å¹¶æ—¶éœ€è¦éå†æ‰€æœ‰èŠ‚ç‚¹ä¸¤é (ä¸€éè®°å½•å·¦å³éƒ¨åˆ†çš„å¤´å’Œå°¾, ä¸€éå®é™…å½’å¹¶), è¿™éƒ¨åˆ†æ—¶é—´å¤æ‚åº¦æ˜¯ O(N), æ‰€ä»¥æ•´ä½“æ—¶é—´å¤æ‚åº¦å°±æ˜¯ O(NlogN)
- ç©ºé—´å¤æ‚åº¦ O(1): åªä½¿ç”¨äº†å‡ ä¸ªå¸¸æ•°ç©ºé—´çš„å˜é‡

#### ä»£ç 

```python
class Solution:
    def sortList(self, head: ListNode) -> ListNode:
        def merge(head1, head2):
            # å°†é“¾è¡¨head1å’Œhead2è¿›è¡Œå½’å¹¶æ’åº
            # ä½¿ç”¨å“¨å…µèŠ‚ç‚¹ç®€åŒ–å¤„ç†
            dummy = ListNode(0)
            cur = dummy
            while head1 or head2:
                if not head2 or head1 and head1.val <= head2.val:
                    # head2ä¸ºç©º, æˆ–è€…head1çš„å€¼æ›´å°, è¿½åŠ head1
                    cur.next = head1
                    # head1å‘åç§»åŠ¨
                    head1 = head1.next
                else:
                    # æ­¤æ—¶åªèƒ½è¿½åŠ head2
                    cur.next = head2
                    # head2å‘åç§»åŠ¨
                    head2 = head2.next
                # å½“å‰èŠ‚ç‚¹å‘åç§»åŠ¨
                cur = cur.next
            # è¿”å›å½’å¹¶æ’åºåçš„é“¾è¡¨å¤´å’Œå°¾
            return (dummy.next, cur)

        # ç»Ÿè®¡åŸå§‹é“¾è¡¨çš„èŠ‚ç‚¹æ•°
        n = 0
        cur = head
        while cur:
            cur = cur.next
            n += 1

        # ä»é•¿åº¦ä¸º1çš„ä¸¤ä¸ªé“¾è¡¨å¼€å§‹å½’å¹¶æ’åº
        cnt = 1
        # ä½¿ç”¨å“¨å…µèŠ‚ç‚¹ç®€åŒ–å¤„ç†
        dummy = ListNode(0, head)
        # åªè¦é•¿åº¦ä¸è¶…è¿‡n, å°±è¯´æ˜æœ‰è‡³å°‘ä¸¤ä¸ªé“¾è¡¨éœ€è¦å½’å¹¶
        while cnt < n:
            # ptailå­˜å‚¨å‰ä¸€ä¸ªå½’å¹¶å¥½çš„é“¾è¡¨çš„æœ«å°¾, åˆå§‹åŒ–ä¸ºå“¨å…µ
            ptail = dummy
            # curæ˜¯å½“å‰å¤„ç†çš„èŠ‚ç‚¹
            cur = dummy.next
            while cur:
                # lheadå’Œltailæ˜¯å½“å‰å¾…å½’å¹¶çš„å·¦ä¾§é“¾è¡¨å¤´å’Œå°¾
                lhead = cur
                ltail = cur
                # éå†lcntä¸ªèŠ‚ç‚¹, å¹¶æ›´æ–°ltailå’Œcur
                lcnt = cnt
                while lcnt > 0 and cur:
                    ltail = cur
                    cur = cur.next
                    lcnt -= 1
                if ltail:
                    # æ–­å¼€ltailå’Œå³ä¾§çš„è¿æ¥
                    ltail.next = None
                # rheadå’Œrtailæ˜¯å½“å‰å¾…å½’å¹¶çš„å³ä¾§é“¾è¡¨å¤´å’Œå°¾
                rhead = cur
                rtail = cur
                # éå†rcntä¸ªèŠ‚ç‚¹, å¹¶æ›´æ–°rtailå’Œcur
                rcnt = cnt
                while rcnt > 0 and cur:
                    rtail = cur
                    cur = cur.next
                    rcnt -= 1
                if rtail:
                    # æ–­å¼€rtailå’Œå³ä¾§çš„è¿æ¥
                    rtail.next = None
                # å½’å¹¶å·¦å³é“¾è¡¨, å¾—åˆ°å½’å¹¶åçš„æ–°é“¾è¡¨çš„å¤´å’Œå°¾
                nhead, ntail = merge(lhead, rhead)
                # å°†å‰ä¸€ä¸ªå½’å¹¶éƒ¨åˆ†çš„å°¾æŒ‡å‘å½“å‰å½’å¹¶éƒ¨åˆ†çš„å¤´
                ptail.next = nhead
                # ç„¶åæ›´æ–°ptailå°¾å½“å‰å½’å¹¶éƒ¨åˆ†çš„å°¾
                ptail = ntail
            # å½’å¹¶é•¿åº¦ä¹˜ä»¥2, ä¸æ–­å¾ªç¯å½’å¹¶æ’åºæ›´å¤§é•¿åº¦çš„ä¸¤éƒ¨åˆ†, ç›´åˆ°æ•´ä¸ªé“¾è¡¨æœ‰åº
            cnt *= 2
        # æœ€ç»ˆå“¨å…µèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å°±æ˜¯å…¨éƒ¨æ’åºåçš„å¤´
        return dummy.next
```

---

> å¤§å®¶å¯ä»¥åœ¨ä¸‹é¢è¿™äº›åœ°æ–¹æ‰¾åˆ°æˆ‘~ğŸ˜Š

> [æˆ‘çš„ GitHub](https://github.com/zjulyx)

> [æˆ‘çš„ Leetcode](https://leetcode-cn.com/u/suibianfahui/)

> [æˆ‘çš„ CSDN](https://me.csdn.net/zjulyx1993)

> [æˆ‘çš„çŸ¥ä¹ä¸“æ ](https://zhuanlan.zhihu.com/c_1242508721932464128)

> [æˆ‘çš„å¤´æ¡å·](https://www.toutiao.com/c/user/1090304683804520/#mid=1671643017345028)

> [æˆ‘çš„ç‰›å®¢ç½‘åšå®¢](https://blog.nowcoder.net/zjulyx)

> æˆ‘çš„å…¬ä¼—å·: [ç®—æ³•ç²¾é€‰](https://mp.weixin.qq.com/s?__biz=MzA5MDk1MjI5MA==&mid=2247484158&idx=1&sn=90176bac32cf7af40e4074c721fd8a95&chksm=900285f3a7750ce5a068c9c9773781461819633f2fd60533732637ec9520c908371ebc218d49&scene=178&cur_album_id=1386231241346859009#rd), æ¬¢è¿å¤§å®¶æ‰«ç å…³æ³¨~ğŸ˜Š

![ç®—æ³•ç²¾é€‰ - å¾®ä¿¡æ‰«ä¸€æ‰«å…³æ³¨æˆ‘](https://pic1.zhimg.com/80/v2-7c988a7b35886df51596ef23616764ac_1440w.jpg)
