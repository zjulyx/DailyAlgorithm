> é¢˜ç›®éš¾åº¦: ä¸­ç­‰

> [åŸé¢˜é“¾æ¥](https://leetcode.cn/problems/Q91FMA/)

> ä»Šå¤©ç»§ç»­æ›´æ–° Leetcode çš„å‰‘æŒ‡ Offerï¼ˆä¸“é¡¹çªå‡»ç‰ˆï¼‰ç³»åˆ—, å¤§å®¶åœ¨å…¬ä¼—å· **ç®—æ³•ç²¾é€‰** é‡Œå›å¤ `å‰‘æŒ‡offer2` å°±èƒ½çœ‹åˆ°è¯¥ç³»åˆ—å½“å‰è¿è½½çš„æ‰€æœ‰æ–‡ç« äº†, è®°å¾—å…³æ³¨å“¦~

## é¢˜ç›®æè¿°

å¦‚æœåºåˆ— X_1, X_2, ..., X_n æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ï¼Œå°±è¯´å®ƒæ˜¯ æ–æ³¢é‚£å¥‘å¼ çš„ï¼š

- n >= 3
- å¯¹äºæ‰€æœ‰ i + 2 <= nï¼Œéƒ½æœ‰ `X_i + X_{i+1} = X_{i+2}`

ç»™å®šä¸€ä¸ªä¸¥æ ¼é€’å¢çš„æ­£æ•´æ•°æ•°ç»„å½¢æˆåºåˆ— arr ï¼Œæ‰¾åˆ° arr ä¸­æœ€é•¿çš„æ–æ³¢é‚£å¥‘å¼çš„å­åºåˆ—çš„é•¿åº¦ã€‚å¦‚æœä¸€ä¸ªä¸å­˜åœ¨ï¼Œè¿”å› 0 ã€‚

ï¼ˆå›æƒ³ä¸€ä¸‹ï¼Œå­åºåˆ—æ˜¯ä»åŸåºåˆ— arr ä¸­æ´¾ç”Ÿå‡ºæ¥çš„ï¼Œå®ƒä» arr ä¸­åˆ æ‰ä»»æ„æ•°é‡çš„å…ƒç´ ï¼ˆä¹Ÿå¯ä»¥ä¸åˆ ï¼‰ï¼Œè€Œä¸æ”¹å˜å…¶ä½™å…ƒç´ çš„é¡ºåºã€‚ä¾‹å¦‚ï¼Œ [3, 5, 8] æ˜¯ [3, 4, 5, 6, 7, 8] çš„ä¸€ä¸ªå­åºåˆ—ï¼‰

### ç¤ºä¾‹ 1ï¼š

- è¾“å…¥: arr = [1,2,3,4,5,6,7,8]
- è¾“å‡º: 5
- è§£é‡Š: æœ€é•¿çš„æ–æ³¢é‚£å¥‘å¼å­åºåˆ—ä¸º [1,2,3,5,8] ã€‚

### ç¤ºä¾‹ 2ï¼š

- è¾“å…¥: arr = [1,3,7,11,12,14,18]
- è¾“å‡º: 3
- è§£é‡Š: æœ€é•¿çš„æ–æ³¢é‚£å¥‘å¼å­åºåˆ—æœ‰ [1,11,12]ã€[3,11,14] ä»¥åŠ [7,11,18] ã€‚

### æç¤ºï¼š

- 3 <= arr.length <= 1000
- 1 <= arr[i] < arr[i + 1] <= 10^9

## é¢˜ç›®æ€è€ƒ

1. å¦‚ä½•å°½å¯èƒ½ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦?

## è§£å†³æ–¹æ¡ˆ

- åˆ†æé¢˜ç›®, ä¸€ä¸ªå¾ˆå®¹æ˜“æƒ³åˆ°çš„æ€è·¯æ˜¯å›ºå®šå¼€å¤´çš„ä¸¤ä¸ªæ•°å­—, ç„¶åæ£€æŸ¥ä¸¤æ•°ä¹‹å’Œæ˜¯å¦å­˜åœ¨äºæ•°ç»„ä¸­, æ˜¯çš„è¯å°†å…¶ä½œä¸ºæ–°çš„æ•°å­—, ç»§ç»­å‘åæ£€æŸ¥
- è¿™é‡Œéœ€è¦ä½¿ç”¨ä¸€ä¸ªé›†åˆå­˜å‚¨æ•°ç»„çš„æ‰€æœ‰å€¼, è¿™æ ·å¯ä»¥å¿«é€Ÿåˆ¤æ–­ä¸¤æ•°ä¹‹å’Œæ˜¯å¦å­˜åœ¨, ä¸è¿‡è¿™ç§åšæ³•çš„æ—¶é—´å¤æ‚åº¦è¾¾åˆ°äº† O(N^3) (ä¸¤é‡å¾ªç¯ O(N^2)å›ºå®šå¼€å¤´, å†…éƒ¨ O(N)å‘åæ£€æŸ¥æ–°æ•°å­—), æœ‰æ²¡æœ‰æ›´ä¼˜çš„åšæ³•å‘¢?
- ä¸éš¾å‘ç°, ä¸Šé¢çš„æ€è·¯è¿›è¡Œäº†å¤§é‡çš„é‡å¤è®¡ç®—, å› ä¸ºå½“ä¸¤å¼€å¤´ä¹‹å’Œå­˜åœ¨äºæ•°ç»„ä¸­æ—¶, æˆ‘ä»¬ä¼šé‡å¤è®¡ç®—ä»¥`(ç¬¬äºŒä¸ªå¼€å¤´, ä¸¤å¼€å¤´ä¹‹å’Œ)`ä½œä¸ºå¼€å¤´çš„å­åºåˆ—, å¦‚æœæˆ‘ä»¬èƒ½æå‰è®°å½•è¿™éƒ¨åˆ†, å°±å¯ä»¥é¿å…é‡å¤è®¡ç®—
- ä¸¾ä¸ªä¾‹å­, å¯¹äºæ•°ç»„`[1,2,3,4,5,6,7,8]`, å‡è®¾å½“å‰éå†åˆ°çš„å¼€å¤´ä¸¤ä¸ªæ•°å­—åˆ†åˆ«æ˜¯ 2 å’Œ 3, å…¶æ•°å­—ä¹‹å’Œæ˜¯ 5, é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æå‰è®¡ç®—å¥½äº†ä»¥ 3 å’Œ 5 å¼€å¤´çš„æœ€é•¿å­åºåˆ—é•¿åº¦, é‚£ä¹ˆ 2 å’Œ 3 å¼€å¤´çš„å­åºåˆ—è‡ªç„¶å°±æ˜¯é‚£ä¸ªé•¿åº¦åŠ  1 (å³åŠ ä¸Šæ–°çš„å¼€å¤´ 2)
- è¿™å°±æ˜¯å…¸å‹çš„åŠ¨æ€è§„åˆ’çš„æ€æƒ³, æˆ‘ä»¬å¯ä»¥ä»åå¾€å‰è¿›è¡Œä¸¤é‡å¾ªç¯, ä½¿ç”¨äºŒç»´ dp æ•°ç»„è®°å½•å¼€å¤´ä¸¤ä¸‹æ ‡æ—¶çš„æœ€é•¿å­åºåˆ—é•¿åº¦, ç„¶åå¦‚æœä¸¤æ•°ä¹‹å’Œå¯¹åº”çš„ä¸‹æ ‡å­˜åœ¨äºæ•°ç»„ä¸­, åˆ™æ›´æ–°å½“å‰ dp å€¼ä¸ºé‚£ä¸ª dp å€¼åŠ  1
- ç”¨æ•°å­¦è¯­è¨€æ¥è¡¨ç¤º, å‡è®¾`dp[i][j]`åˆ†åˆ«ä»£è¡¨ä»¥`arr[i]`å’Œ`arr[j]`ä½œä¸ºå¼€å¤´ä¸¤ä¸ªæ•°å­—æ—¶çš„æœ€é•¿å­åºåˆ—é•¿åº¦, é‚£ä¹ˆå°±æœ‰:
  - `if arr[i]+arr[j] in arr and its index is k: dp[i][j]=dp[j][k]+1`
  - `else: dp[i][j]=2`
- ç„¶åç”±äºæœ‰æ•ˆå­åºåˆ—è¦æ±‚é•¿åº¦è‡³å°‘ä¸º 3, æ‰€ä»¥åªæœ‰å½“ dp å€¼å¤§äºç­‰äº 3 æ—¶æ‰æ›´æ–°æœ€ç»ˆç»“æœ
- å¦å¤–æˆ‘ä»¬éœ€è¦å¿«é€Ÿå¾—åˆ°æŸä¸ªå€¼æ˜¯å¦åœ¨æ•°ç»„ä¸­ä»¥åŠå…¶å¯¹åº”ä¸‹æ ‡, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªä¸‹æ ‡å­—å…¸, å­˜å‚¨æ•°ç»„å€¼åˆ°å…¶ä¸‹æ ‡çš„æ˜ å°„å…³ç³», å› ä¸ºé¢˜ç›®ç»™å‡ºçš„æ•°ç»„æ˜¯ä¸¥æ ¼é€’å¢çš„, æ‰€ä»¥æ¯ä¸ªæ•°å­—éƒ½ä¸é‡å¤, æ²¡æœ‰é‡å¤ key çš„é—®é¢˜
- ä¸‹é¢çš„ä»£ç ä¸­æœ‰è¯¦ç»†çš„æ³¨é‡Š, æ–¹ä¾¿å¤§å®¶ç†è§£

#### å¤æ‚åº¦

- æ—¶é—´å¤æ‚åº¦ `O(N^2)`: éœ€è¦ä¸¤é‡éå†æ•°ç»„
- ç©ºé—´å¤æ‚åº¦ `O(N^2)`: äºŒç»´ DP æ•°ç»„çš„ç©ºé—´æ¶ˆè€—

#### ä»£ç 

```python
class Solution:
    def lenLongestFibSubseq(self, arr: List[int]) -> int:
        ### äºŒç»´DP+å¾ªç¯å¼€å¤´ij+ä¸‹æ ‡å­—å…¸æ±‚k
        n = len(arr)
        # {x:i}ä¸‹æ ‡å­—å…¸
        d = {x: i for i, x in enumerate(arr)}
        # dp[i][j]å­˜å‚¨å¼€å¤´ä¸¤ä½æ˜¯ä¸‹æ ‡iå’Œjçš„æœ€å¤§é•¿åº¦, åˆå§‹å€¼éƒ½æ˜¯2, å› ä¸ºè‡³å°‘æœ‰ä¸¤ä¸ªå…ƒç´ 
        dp = [[2] * n for _ in range(n)]
        res = 0
        for i in range(n)[::-1]:
            for j in range(i + 1, n)[::-1]:
                # æ³¨æ„iå’Œjéƒ½éœ€è¦é€†åºéå†, è¿™æ ·æ‰èƒ½ä¿è¯åç»­åºåˆ—çš„dpå€¼å·²ç»è¢«è®¡ç®—å¥½
                # è®¡ç®—å¾—åˆ°ä¸‹ä¸€ä½çš„æ•°å­—, å¦‚æœå­˜åœ¨äºä¸‹æ ‡å­—å…¸ä¸­, åˆ™æ›´æ–°é•¿åº¦
                nex = arr[i] + arr[j]
                if nex in d:
                    # å­˜åœ¨åç»­å­åºåˆ—, ä½¿ç”¨å¯¹åº”dpå€¼åŠ 1
                    k = d[nex]
                    dp[i][j] = dp[j][k] + 1
                if dp[i][j] >= 3:
                    # åªæœ‰é•¿åº¦è‡³å°‘ä¸º3æ—¶æ‰æ˜¯æœ‰æ•ˆçš„å­åºåˆ—
                    res = max(res, dp[i][j])
        return res
```

---

> å¤§å®¶å¯ä»¥åœ¨ä¸‹é¢è¿™äº›åœ°æ–¹æ‰¾åˆ°æˆ‘~ğŸ˜Š

> [æˆ‘çš„ GitHub](https://github.com/zjulyx)

> [æˆ‘çš„ Leetcode](https://leetcode-cn.com/u/suibianfahui/)

> [æˆ‘çš„ CSDN](https://me.csdn.net/zjulyx1993)

> [æˆ‘çš„çŸ¥ä¹ä¸“æ ](https://zhuanlan.zhihu.com/c_1242508721932464128)

> [æˆ‘çš„å¤´æ¡å·](https://www.toutiao.com/c/user/1090304683804520/#mid=1671643017345028)

> [æˆ‘çš„ç‰›å®¢ç½‘åšå®¢](https://blog.nowcoder.net/zjulyx)

> æˆ‘çš„å…¬ä¼—å·: [ç®—æ³•ç²¾é€‰](https://mp.weixin.qq.com/s?__biz=MzA5MDk1MjI5MA==&mid=2247484158&idx=1&sn=90176bac32cf7af40e4074c721fd8a95&chksm=900285f3a7750ce5a068c9c9773781461819633f2fd60533732637ec9520c908371ebc218d49&scene=178&cur_album_id=1386231241346859009#rd), æ¬¢è¿å¤§å®¶æ‰«ç å…³æ³¨~ğŸ˜Š

![ç®—æ³•ç²¾é€‰ - å¾®ä¿¡æ‰«ä¸€æ‰«å…³æ³¨æˆ‘](https://pic1.zhimg.com/80/v2-7c988a7b35886df51596ef23616764ac_1440w.jpg)
