> é¢˜ç›®éš¾åº¦: ç®€å•

> [åŸé¢˜é“¾æ¥](https://leetcode.cn/problems/w3tCBm/)

> ä»Šå¤©ç»§ç»­æ›´æ–° Leetcode çš„å‰‘æŒ‡ Offerï¼ˆä¸“é¡¹çªå‡»ç‰ˆï¼‰ç³»åˆ—, å¤§å®¶åœ¨å…¬ä¼—å· **ç®—æ³•ç²¾é€‰** é‡Œå›å¤ `å‰‘æŒ‡offer2` å°±èƒ½çœ‹åˆ°è¯¥ç³»åˆ—å½“å‰è¿è½½çš„æ‰€æœ‰æ–‡ç« äº†, è®°å¾—å…³æ³¨å“¦~

## é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•° nÂ ï¼Œè¯·è®¡ç®— 0 åˆ° n ä¹‹é—´çš„æ¯ä¸ªæ•°å­—çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­ 1 çš„ä¸ªæ•°ï¼Œå¹¶è¾“å‡ºä¸€ä¸ªæ•°ç»„ã€‚

### ç¤ºä¾‹ 1:

- è¾“å…¥: n = 2
- è¾“å‡º: [0,1,1]
- è§£é‡Š:

```
0 --> 0
1 --> 1
2 --> 10
```

### ç¤ºä¾‹ Â 2:

- è¾“å…¥: n = 5
- è¾“å‡º: [0,1,1,2,1,2]
- è§£é‡Š:

```
0 --> 0
1 --> 1
2 --> 10
3 --> 11
4 --> 100
5 --> 101
```

### è¯´æ˜ :

0 <= n <= 10^5

### è¿›é˜¶:

- ç»™å‡ºæ—¶é—´å¤æ‚åº¦ä¸º Â O(n\*sizeof(integer))Â  çš„è§£ç­”éå¸¸å®¹æ˜“ã€‚ä½†ä½ å¯ä»¥åœ¨çº¿æ€§æ—¶é—´ Â O(n)Â  å†…ç”¨ä¸€è¶Ÿæ‰«æåšåˆ°å—ï¼Ÿ
- è¦æ±‚ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦ä¸º Â O(n)Â ã€‚
- ä½ èƒ½è¿›ä¸€æ­¥å®Œå–„è§£æ³•å—ï¼Ÿè¦æ±‚åœ¨ C++æˆ–ä»»ä½•å…¶ä»–è¯­è¨€ä¸­ä¸ä½¿ç”¨ä»»ä½•å†…ç½®å‡½æ•°ï¼ˆå¦‚ C++ ä¸­çš„ Â \_\_builtin_popcountÂ ï¼‰æ¥æ‰§è¡Œæ­¤æ“ä½œã€‚

## é¢˜ç›®æ€è€ƒ

1. å¦‚ä½•åšåˆ°çº¿æ€§æ—¶é—´ä¸€è¶Ÿæ‰«æ?
2. å‰åæ•°å­—ä¹‹é—´æ˜¯å¦æœ‰å…³è”?

## è§£å†³æ–¹æ¡ˆ

### æ€è·¯

- åˆ†æé¢˜ç›®, ä¸€ä¸ªå¾ˆå®¹æ˜“æƒ³åˆ°çš„æ–¹æ³•å°±æ˜¯ä» 0 éå†åˆ° N, ç„¶åä¾æ¬¡ç»Ÿè®¡æ¯ä¸ªæ•°å­—çš„äºŒè¿›åˆ¶ 1 çš„æ•°ç›® (ä¸æ–­å³ç§»å¹¶æ£€æŸ¥æœ€ä½ä½æ•°å­—, æ˜¯ 1 åˆ™ç´¯åŠ è®¡æ•°)
- ä½†è¿™ç§ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(n\*sizeof(integer)), å¦‚ä½•è¾¾åˆ°é¢˜ç›®é‡Œçš„è¿›é˜¶è¦æ±‚ (çº¿æ€§æ—¶é—´ä¸€è¶Ÿæ‰«æ) å‘¢?
- å¦‚æœåœ¨è®¡ç®—åé¢æ•°å­—çš„ 1 çš„ä¸ªæ•°æ—¶, èƒ½åˆ©ç”¨ä¹‹å‰æ•°å­—çš„è®¡ç®—ç»“æœ, è¿™æ ·æˆ‘ä»¬å°±æ— éœ€è¯¸ä½ç»Ÿè®¡äº†
- ä¾‹å¦‚å¯¹äºäºŒè¿›åˆ¶æ•° 0b1011 æ¥è¯´, å®ƒæœ‰ 3 ä¸ª 1, ç›¸æ¯” 0b1010 å¤šäº†æœ€ä½ä½çš„ 1
- è¿™æ ·å°±å¯ä»¥å°†é—®é¢˜è½¬æ¢æˆæ±‚å°†æœ€ä½ä½ 1 ç¿»è½¬æˆ 0 çš„æ•°å­—äº†, é‚£å¦‚ä½•æ±‚è§£å‘¢?
- å¦‚æœå½“å‰æ•°å­— n çš„ä¸ªä½æ˜¯ 1, æ˜¾ç„¶ n-1 å°±å¯ä»¥å°†æœ€ä½ä½ç¿»è½¬æˆ 0 äº†, é‚£å¯¹äºä¸ªä½ä¸æ˜¯ 1 çš„æ•°å­—å‘¢?
- æ­¤æ—¶ n çš„æœ€ä½ä½ 1 åé¢ä¸€å®šå…¨æ˜¯ 0, æ‰€ä»¥ n é•¿è¿™æ ·: 0bxxx1000, n-1 çš„è¯å°±æ˜¯ 0bxxx0111
- é‚£ä¹ˆå°† n-1 ä¸ n æ±‚ä¸, å¾—åˆ°çš„ç»“æœå°±æ˜¯ 0bxxx0000, æ­£æ˜¯å°† n çš„æœ€ä½ä½ 1 ç¿»è½¬æˆ 0 çš„æ•°å­—
- ç»¼åˆä¸Šè¿°ä¸¤ç§æƒ…å†µ, n&(n-1) å³å¯å¾—åˆ° 1 çš„æ•°ç›®æ¯” n å°‘ 1 çš„æ•°å­— (å› ä¸ºå³ä½¿ä¸ªä½æ˜¯ 1, n&(n-1)è¿˜æ˜¯ n-1)
- æ‰€ä»¥ n çš„ 1 çš„æ•°ç›®å°±æ˜¯ n&(n-1)çš„ 1 çš„æ•°ç›®åŠ  1
- æˆ‘ä»¬ä¾æ¬¡ä» 1 å¼€å§‹éå†åˆ° n, åˆ©ç”¨ä¸Šè¿°è§„åˆ™å³å¯åœ¨çº¿æ€§æ—¶é—´å†…ä¸€è¶Ÿæ‰«ææ±‚å‡ºæ‰€æœ‰æ•°å­—çš„ 1 çš„æ•°ç›®

### å¤æ‚åº¦

- æ—¶é—´å¤æ‚åº¦ O(N): çº¿æ€§æ—¶é—´, ä¸€è¶Ÿæ‰«æ
- ç©ºé—´å¤æ‚åº¦ O(N): æœ€ç»ˆç»“æœæ•°ç»„éœ€è¦å­˜ N ä¸ªæ•°å­—

### ä»£ç 

```python
class Solution:
    def countBits(self, n: int) -> List[int]:
        res = [0] * (n + 1)
        for mask in range(1, n + 1):
            # preæ˜¯maskå°†æœ€ä½ä½1å˜æˆ0åçš„æ•°å­—
            pre = mask & (mask - 1)
            # maskç›¸æ¯”preå¤šäº†ä¸€ä¸ª1
            res[mask] = res[pre] + 1
        return res
```

---

> å¤§å®¶å¯ä»¥åœ¨ä¸‹é¢è¿™äº›åœ°æ–¹æ‰¾åˆ°æˆ‘~ğŸ˜Š

> [æˆ‘çš„ GitHub](https://github.com/zjulyx)

> [æˆ‘çš„ Leetcode](https://leetcode-cn.com/u/suibianfahui/)

> [æˆ‘çš„ CSDN](https://me.csdn.net/zjulyx1993)

> [æˆ‘çš„çŸ¥ä¹ä¸“æ ](https://zhuanlan.zhihu.com/c_1242508721932464128)

> [æˆ‘çš„å¤´æ¡å·](https://www.toutiao.com/c/user/1090304683804520/#mid=1671643017345028)

> [æˆ‘çš„ç‰›å®¢ç½‘åšå®¢](https://blog.nowcoder.net/zjulyx)

> æˆ‘çš„å…¬ä¼—å·: [ç®—æ³•ç²¾é€‰](https://mp.weixin.qq.com/s?__biz=MzA5MDk1MjI5MA==&mid=2247484158&idx=1&sn=90176bac32cf7af40e4074c721fd8a95&chksm=900285f3a7750ce5a068c9c9773781461819633f2fd60533732637ec9520c908371ebc218d49&scene=178&cur_album_id=1386231241346859009#rd), æ¬¢è¿å¤§å®¶æ‰«ç å…³æ³¨~ğŸ˜Š

![ç®—æ³•ç²¾é€‰ - å¾®ä¿¡æ‰«ä¸€æ‰«å…³æ³¨æˆ‘](https://pic1.zhimg.com/80/v2-7c988a7b35886df51596ef23616764ac_1440w.jpg)
