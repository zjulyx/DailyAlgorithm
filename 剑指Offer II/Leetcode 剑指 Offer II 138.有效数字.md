> 题目难度: 中等

> [原题链接](https://leetcode.cn/problems/biao-shi-shu-zhi-de-zi-fu-chuan-lcof/)

> 今天继续更新 Leetcode 的剑指 Offer（专项突击版）系列, 大家在公众号 **算法精选** 里回复 `剑指offer2` 就能看到该系列当前连载的所有文章了, 记得关注哦~

## 题目描述

- 有效数字（按顺序）可以分成以下几个部分：
  - 若干空格
  - 一个 小数 或者 整数
  - （可选）一个 'e' 或 'E' ，后面跟着一个 整数
  - 若干空格
- 小数（按顺序）可以分成以下几个部分：
  - （可选）一个符号字符（'+' 或 '-'）
  - 下述格式之一：
    - 至少一位数字，后面跟着一个点 '.'
    - 至少一位数字，后面跟着一个点 '.' ，后面再跟着至少一位数字
    - 一个点 '.' ，后面跟着至少一位数字
- 整数（按顺序）可以分成以下几个部分：
  - （可选）一个符号字符（'+' 或 '-'）
  - 至少一位数字
- 部分有效数字列举如下：["2", "0089", "-0.1", "+3.14", "4.", "-.9", "2e10", "-90E3", "3e+7", "+6e-1", "53.5e93", "-123.456e789"]
- 部分无效数字列举如下：["abc", "1a", "1e", "e3", "99e2.5", "--6", "-+3", "95a54e53"]
- 给你一个字符串 s ，如果 s 是一个 有效数字 ，请返回 true 。

### 示例 1：

- 输入：s = "0"
- 输出：true

### 示例 2：

- 输入：s = "e"
- 输出：false

### 示例 3：

- 输入：s = "."
- 输出：false

### 提示：

- 1 <= s.length <= 20
- s 仅含英文字母（大写和小写），数字（0-9），加号 '+' ，减号 '-' ，空格 ' ' 或者点 '.' 。

## 题目思考

1. 如何高效地处理各类情况?
2. 边界情况分为几类?

## 解决方案

### 思路

- 首先确定字符串中允许有哪些字符, 以及各自需要满足什么条件 (如果面试遇到这种问题, 在模糊的地方一定要多沟通细节, 比如前导 0, 小数点位置等):
  - 数字
    - 数量没有上限, 但至少需要有 1 个
    - 无需处理前导 0 (因为题目用例里 0123 是有效的)
  - `e/E`
    - 只能有 1 个
    - **左右都必须有至少一个数字**
  - `+/-`
    - `e/E` 的两边可以每边最多出现 1 个
    - 都必须在开头
  - `.`
    - 只能有 1 个
    - 只能出现在 `e/E` 之前
    - 可以出现在开头符号之后或数字之间
  - 空格
    - 只能出现在开头和末尾
- 根据上面分析, 一个自然的思路就是按照 `e/E` 将数字分为左右两部分, 其中右边唯一要求是不能有小数点, 别的和左边一样
- 这样我们就可以将分析数字的部分提取成一个方法, 额外传入一个 flag 表示是否可以有小数点, 然后分左右两部分判断即可~ 当然如果没有 `e/E` 的话那直接判断一次就行
- 下面代码完全基于上述分析实现, 必要步骤都有详细注释

### 复杂度

- 时间复杂度 `O(N)`
  - 只需要对每个字符判断一次
- 空间复杂度 `O(1)`
  - 只使用了常数个变量

### 代码

```python
class Solution:
    def validNumber(self, s: str) -> bool:
        # 先要把首尾空格去掉
        # 然后判断是否有e/E
        # 有的话分成左右两部分check, 左边可以有小数, 右边不能有
        # 注意小数点可以位于任意位置..
        # 注意e/E之后不能有小数点
        # 注意每一部分判断时需要保证至少有一个数字
        s = s.strip()

        def isValid(s, allowdot):
            hasNum = False
            hasDot = False
            for i, c in enumerate(s):
                if c == '+' or c == '-':
                    # 先判断符号, 如果不是在开头, 直接返回False
                    if i != 0:
                        return False
                elif c == '.':
                    if not allowdot:
                        # 当前不能有小数点, 返回False
                        return False
                    if hasDot:
                        # 已经有一个小数点了, 返回False
                        return False
                    hasDot = True
                elif c.isnumeric():
                    # 注意这里至少需要满足有一个数字
                    hasNum = True
                else:
                    # 其他字符都不满足, 直接返回False (包括e/E, 因为e/E只允许有一个, 有的话已经作为分隔符用掉了)
                    return False
            return hasNum

        e = max(s.find('e'), s.find('E'))
        if e == -1:
            # 当前字符串没有e/E, 直接判断整体即可, 也允许小数点
            return isValid(s, True)
        else:
            # 分为左右部分分别判断, 左边可以有小数点, 右边不行
            return isValid(s[0:e], True) and isValid(s[e + 1:], False)
```

---

> 大家可以在下面这些地方找到我~😊

> [我的 GitHub](https://github.com/zjulyx)

> [我的 Leetcode](https://leetcode-cn.com/u/suibianfahui/)

> [我的 CSDN](https://me.csdn.net/zjulyx1993)

> [我的知乎专栏](https://zhuanlan.zhihu.com/c_1242508721932464128)

> [我的头条号](https://www.toutiao.com/c/user/1090304683804520/#mid=1671643017345028)

> [我的牛客网博客](https://blog.nowcoder.net/zjulyx)

> 我的公众号: [算法精选](https://mp.weixin.qq.com/s?__biz=MzA5MDk1MjI5MA==&mid=2247484158&idx=1&sn=90176bac32cf7af40e4074c721fd8a95&chksm=900285f3a7750ce5a068c9c9773781461819633f2fd60533732637ec9520c908371ebc218d49&scene=178&cur_album_id=1386231241346859009#rd), 欢迎大家扫码关注~😊

![算法精选 - 微信扫一扫关注我](https://pic1.zhimg.com/80/v2-7c988a7b35886df51596ef23616764ac_1440w.jpg)
