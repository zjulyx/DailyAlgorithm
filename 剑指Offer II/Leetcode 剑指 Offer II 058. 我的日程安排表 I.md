> é¢˜ç›®éš¾åº¦: ä¸­ç­‰

> [åŸé¢˜é“¾æ¥](https://leetcode.cn/problems/fi9suh/)

> ä»Šå¤©ç»§ç»­æ›´æ–° Leetcode çš„å‰‘æŒ‡ Offerï¼ˆä¸“é¡¹çªå‡»ç‰ˆï¼‰ç³»åˆ—, å¤§å®¶åœ¨å…¬ä¼—å· **ç®—æ³•ç²¾é€‰** é‡Œå›å¤ `å‰‘æŒ‡offer2` å°±èƒ½çœ‹åˆ°è¯¥ç³»åˆ—å½“å‰è¿è½½çš„æ‰€æœ‰æ–‡ç« äº†, è®°å¾—å…³æ³¨å“¦~

## é¢˜ç›®æè¿°

- è¯·å®ç°ä¸€ä¸ª MyCalendar ç±»æ¥å­˜æ”¾ä½ çš„æ—¥ç¨‹å®‰æ’ã€‚å¦‚æœè¦æ·»åŠ çš„æ—¶é—´å†…æ²¡æœ‰å…¶ä»–å®‰æ’ï¼Œåˆ™å¯ä»¥å­˜å‚¨è¿™ä¸ªæ–°çš„æ—¥ç¨‹å®‰æ’ã€‚

- MyCalendar æœ‰ä¸€ä¸ª book(int start, int end)æ–¹æ³•ã€‚å®ƒæ„å‘³ç€åœ¨ start åˆ° end æ—¶é—´å†…å¢åŠ ä¸€ä¸ªæ—¥ç¨‹å®‰æ’ï¼Œæ³¨æ„ï¼Œè¿™é‡Œçš„æ—¶é—´æ˜¯åŠå¼€åŒºé—´ï¼Œå³ [start, end), å®æ•° x çš„èŒƒå›´ä¸ºï¼Œ start <= x < endã€‚

- å½“ä¸¤ä¸ªæ—¥ç¨‹å®‰æ’æœ‰ä¸€äº›æ—¶é—´ä¸Šçš„äº¤å‰æ—¶ï¼ˆä¾‹å¦‚ä¸¤ä¸ªæ—¥ç¨‹å®‰æ’éƒ½åœ¨åŒä¸€æ—¶é—´å†…ï¼‰ï¼Œå°±ä¼šäº§ç”Ÿé‡å¤é¢„è®¢ã€‚

- æ¯æ¬¡è°ƒç”¨ MyCalendar.book æ–¹æ³•æ—¶ï¼Œå¦‚æœå¯ä»¥å°†æ—¥ç¨‹å®‰æ’æˆåŠŸæ·»åŠ åˆ°æ—¥å†ä¸­è€Œä¸ä¼šå¯¼è‡´é‡å¤é¢„è®¢ï¼Œè¿”å› trueã€‚å¦åˆ™ï¼Œè¿”å› false å¹¶ä¸”ä¸è¦å°†è¯¥æ—¥ç¨‹å®‰æ’æ·»åŠ åˆ°æ—¥å†ä¸­ã€‚

- è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è°ƒç”¨ MyCalendar ç±»: MyCalendar cal = new MyCalendar(); MyCalendar.book(start, end)

### ç¤ºä¾‹:

- è¾“å…¥:
  - ["MyCalendar","book","book","book"]
  - [[],[10,20],[15,25],[20,30]]
- è¾“å‡º:
  - [null,true,false,true]
- è§£é‡Š:
  - MyCalendar myCalendar = new MyCalendar();
  - MyCalendar.book(10, 20); // returns true
  - MyCalendar.book(15, 25); // returns false ï¼Œç¬¬äºŒä¸ªæ—¥ç¨‹å®‰æ’ä¸èƒ½æ·»åŠ åˆ°æ—¥å†ä¸­ï¼Œå› ä¸ºæ—¶é—´ 15 å·²ç»è¢«ç¬¬ä¸€ä¸ªæ—¥ç¨‹å®‰æ’é¢„å®šäº†
  - MyCalendar.book(20, 30); // returns true ï¼Œç¬¬ä¸‰ä¸ªæ—¥ç¨‹å®‰æ’å¯ä»¥æ·»åŠ åˆ°æ—¥å†ä¸­ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªæ—¥ç¨‹å®‰æ’å¹¶ä¸åŒ…å«æ—¶é—´ 20

### æç¤ºï¼š

- æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œè°ƒç”¨ MyCalendar.book å‡½æ•°æœ€å¤šä¸è¶…è¿‡ 1000 æ¬¡ã€‚
- 0 <= start < end <= 10^9

## é¢˜ç›®æ€è€ƒ

1. å¦‚ä½•ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦?

## è§£å†³æ–¹æ¡ˆ

#### æ€è·¯

- åˆ†æé¢˜ç›®, ä¸€ä¸ªå¾ˆå®¹æ˜“æƒ³åˆ°çš„æ€è·¯å°±æ˜¯æš´åŠ›æ³•: è®°å½•å½“å‰æ‰€æœ‰åŒºé—´, ç„¶å book æ–°åŒºé—´æ—¶ä¾æ¬¡éå†å®ƒä»¬, å¦‚æœå’Œæ–°åŒºé—´æœ‰é‡å , åˆ™è¿”å› false, å¦åˆ™éå†ç»“æŸåæ’å…¥æ–°åŒºé—´, å¹¶è¿”å› true
- ä¸è¿‡è¿™ç§åšæ³•çš„æ—¶é—´å¤æ‚åº¦è¾¾åˆ°äº† O(N^2), æœ‰æ²¡æœ‰åŠæ³•ä¼˜åŒ–å‘¢?
- å…¶å®åœ¨æ’å…¥æ–°åŒºé—´æ—¶, æˆ‘ä»¬å¹¶ä¸éœ€è¦åˆ¤æ–­å·²æœ‰çš„æ‰€æœ‰åŒºé—´, è€Œæ˜¯åªéœ€è¦åˆ¤æ–­æŒ‰é¡ºåºç´§æŒ¨ç€æ–°åŒºé—´çš„å·¦å³ä¸¤ä¸ªåŒºé—´å³å¯: å¦‚æœå®ƒä»¬ä»»ä½•ä¸€ä¸ªæœ‰é‡å , åˆ™ä¸èƒ½æ’å…¥; å¦åˆ™å°±ä¸€å®šå¯ä»¥æ’å…¥, å› ä¸ºå…¶ä»–å·²æœ‰åŒºé—´ç¦»æ–°åŒºé—´æ›´è¿œ, æ›´ä¸å¯èƒ½å’Œæ–°åŒºé—´æœ‰é‡å 
- è¿™å°±å¼•å…¥äº†ä¸€ä¸ªæ–°æ€è·¯: ç”¨ä¸€ä¸ªæœ‰åºæ•°ç»„æ¥å­˜å‚¨å½“å‰å·²æœ‰åŒºé—´, è¿™æ ·å°±å¯ä»¥æ ¹æ®èµ·ç‚¹è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾, å¿«é€Ÿæ‰¾åˆ°æ–°åŒºé—´çš„å·¦å³é‚»å±…äº†
- å‡è®¾å½“å‰æœ‰åºæ•°ç»„æ˜¯ calendars, æ–°åŒºé—´ä¸º cur, è€ŒäºŒåˆ†æŸ¥æ‰¾æ‰¾åˆ°çš„æ’å…¥ä¸‹æ ‡ä¸º i, é‚£ä¹ˆå…¶é¡ºåºä¸€å®šæ˜¯ `[calendars[i-1], cur, calendars[i]]`, ä¹Ÿå³æ–°åŒºé—´çš„å·¦å³é‚»å±…å°±æ˜¯ä¸‹æ ‡ i-1 å’Œ i
- è€Œæ’å…¥æ–°åŒºé—´æ—¶ä¹Ÿè¦ä¿è¯æœ‰åºæ€§, è¿™æ ·åç»­æ‰å¯ä»¥ç»§ç»­äºŒåˆ†æŸ¥æ‰¾
- å¯¹äº Python3, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ sortedcontainers åº“çš„ SortedList åšåˆ°è¿™ä¸€ç‚¹, å®ƒæä¾›äº†äºŒåˆ†æŸ¥æ‰¾æ–¹æ³•, ä¸”å®ƒçš„ add æ–¹æ³•èƒ½ä¿è¯æ’å…¥åä»ä¿è¯æœ‰åº
- ä¸‹é¢ä»£ç ä¸­æœ‰è¯¦ç»†çš„æ³¨é‡Š, æ–¹ä¾¿å¤§å®¶ç†è§£

#### å¤æ‚åº¦

- æ—¶é—´å¤æ‚åº¦ O(NlogN): æ¯æ¬¡ book æ“ä½œæ—¶çš„äºŒåˆ†æŸ¥æ‰¾å’Œæœ‰åºæ•°ç»„æ’å…¥éƒ½æ˜¯ O(logN), å…±æœ‰ N æ¬¡ book æ“ä½œ, æ‰€ä»¥æ€»å…±æ˜¯ O(NlogN)
- ç©ºé—´å¤æ‚åº¦ O(N): é¢å¤–æœ‰åºæ•°ç»„å­˜å‚¨æ‰€æœ‰åŒºé—´

#### ä»£ç 

```python
from sortedcontainers import SortedList


class MyCalendar:
    def __init__(self):
        self.calendars = SortedList()

    def hasIntersect(self, range1, range2):
        # åˆ¤æ–­ä¸¤ä¸ªåŒºé—´æ˜¯å¦æœ‰é‡å 
        s1, e1 = range1
        s2, e2 = range2
        return not (s2 >= e1 or s1 >= e2)

    def book(self, start: int, end: int) -> bool:
        # äºŒåˆ†æŸ¥æ‰¾å½“å‰åŒºé—´åº”è¯¥æ’å…¥çš„ä½ç½®
        i = self.calendars.bisect_left([start, end])
        for j in (i - 1, i):
            # åªéœ€è¦åˆ¤æ–­å½“å‰åŒºé—´curçš„å·¦å³ä¸¤ä¸ªç›¸é‚»åŒºé—´, å³[calendars[i-1], cur, calendars[i]]
            if 0 <= j < len(self.calendars) and self.hasIntersect(self.calendars[j], [start, end]):
                return False
        self.calendars.add([start, end])
        return True
```

---

> å¤§å®¶å¯ä»¥åœ¨ä¸‹é¢è¿™äº›åœ°æ–¹æ‰¾åˆ°æˆ‘~ğŸ˜Š

> [æˆ‘çš„ GitHub](https://github.com/zjulyx)

> [æˆ‘çš„ Leetcode](https://leetcode-cn.com/u/suibianfahui/)

> [æˆ‘çš„ CSDN](https://me.csdn.net/zjulyx1993)

> [æˆ‘çš„çŸ¥ä¹ä¸“æ ](https://zhuanlan.zhihu.com/c_1242508721932464128)

> [æˆ‘çš„å¤´æ¡å·](https://www.toutiao.com/c/user/1090304683804520/#mid=1671643017345028)

> [æˆ‘çš„ç‰›å®¢ç½‘åšå®¢](https://blog.nowcoder.net/zjulyx)

> æˆ‘çš„å…¬ä¼—å·: [ç®—æ³•ç²¾é€‰](https://mp.weixin.qq.com/s?__biz=MzA5MDk1MjI5MA==&mid=2247484158&idx=1&sn=90176bac32cf7af40e4074c721fd8a95&chksm=900285f3a7750ce5a068c9c9773781461819633f2fd60533732637ec9520c908371ebc218d49&scene=178&cur_album_id=1386231241346859009#rd), æ¬¢è¿å¤§å®¶æ‰«ç å…³æ³¨~ğŸ˜Š

![ç®—æ³•ç²¾é€‰ - å¾®ä¿¡æ‰«ä¸€æ‰«å…³æ³¨æˆ‘](https://pic1.zhimg.com/80/v2-7c988a7b35886df51596ef23616764ac_1440w.jpg)
